2025-06-06 11:56:11,434 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 11:56:11,819 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 11:56:11,831 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 11:57:35,313 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 11:57:36,395 - data.model - INFO - Using device: cuda
2025-06-06 11:57:36,395 - data.model - INFO - Loading CLIP model...
2025-06-06 11:57:43,414 - data.model - INFO - CLIP model loaded successfully
2025-06-06 11:57:43,420 - data.model - INFO - Loading SBERT model...
2025-06-06 11:57:43,427 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 11:57:49,643 - data.model - INFO - SBERT model loaded successfully
2025-06-06 11:57:49,643 - data.model - INFO - Loading BLIP model...
2025-06-06 11:57:56,862 - data.model - INFO - BLIP model loaded successfully
2025-06-06 11:57:56,862 - data.model - INFO - Configuring Gemini API...
2025-06-06 11:57:56,863 - data.model - INFO - Gemini API configured successfully
2025-06-06 11:57:56,865 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 11:57:56,865 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 11:57:56,865 - data.model - INFO - Loading models...
2025-06-06 11:58:08,832 - data.model - INFO - Models loaded successfully!
2025-06-06 11:58:08,834 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:02:08,042 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:02:08,073 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:02:08,089 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:02:20,205 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:02:20,699 - data.model - INFO - Using device: cuda
2025-06-06 12:02:20,699 - data.model - INFO - Loading CLIP model...
2025-06-06 12:02:25,880 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:02:25,880 - data.model - INFO - Loading SBERT model...
2025-06-06 12:02:25,880 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:02:31,331 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:02:31,342 - data.model - INFO - Loading BLIP model...
2025-06-06 12:02:36,950 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:02:36,950 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:02:36,950 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:02:36,950 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:02:36,950 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:02:36,950 - data.model - INFO - Loading models...
2025-06-06 12:02:48,275 - data.model - INFO - Models loaded successfully!
2025-06-06 12:02:48,275 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:02:48,831 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:02:48,837 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:02:48,837 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:02:48,837 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:02:49,489 - data.model - INFO - Indexes built successfully!
2025-06-06 12:02:49,518 - data.model - INFO - Loading dataset...
2025-06-06 12:02:49,855 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:02:49,865 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:02:49,865 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:02:49,865 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:03:12,979 - __main__ - INFO - Health check requested
2025-06-06 12:03:25,175 - __main__ - INFO - Health check requested
2025-06-06 12:03:49,455 - __main__ - INFO - Health check requested
2025-06-06 12:03:50,776 - __main__ - INFO - Health check requested
2025-06-06 12:03:50,963 - __main__ - INFO - Health check requested
2025-06-06 12:03:51,176 - __main__ - INFO - Health check requested
2025-06-06 12:08:45,254 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:08:45,282 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:08:45,292 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:08:56,744 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:08:57,232 - data.model - INFO - Using device: cuda
2025-06-06 12:08:57,232 - data.model - INFO - Loading CLIP model...
2025-06-06 12:09:01,456 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:09:01,456 - data.model - INFO - Loading SBERT model...
2025-06-06 12:09:01,456 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:09:06,072 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:09:06,072 - data.model - INFO - Loading BLIP model...
2025-06-06 12:09:12,019 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:09:12,019 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:09:12,019 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:09:12,019 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:09:12,019 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:09:12,019 - data.model - INFO - Loading models...
2025-06-06 12:09:23,968 - data.model - INFO - Models loaded successfully!
2025-06-06 12:09:23,969 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:09:24,424 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:09:24,425 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:09:24,425 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:09:24,425 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:09:24,996 - data.model - INFO - Indexes built successfully!
2025-06-06 12:09:25,013 - data.model - INFO - Loading dataset...
2025-06-06 12:09:25,288 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:09:25,288 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:09:25,288 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:09:25,288 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:09:40,914 - __main__ - INFO - Health check requested
2025-06-06 12:09:41,974 - __main__ - INFO - Health check requested
2025-06-06 12:09:42,145 - __main__ - INFO - Health check requested
2025-06-06 12:09:42,321 - __main__ - INFO - Health check requested
2025-06-06 12:09:44,334 - __main__ - INFO - Health check requested
2025-06-06 12:09:44,556 - __main__ - INFO - Health check requested
2025-06-06 12:09:44,986 - __main__ - INFO - Health check requested
2025-06-06 12:09:45,156 - __main__ - INFO - Health check requested
2025-06-06 12:09:55,110 - __main__ - INFO - Received recommendation request
2025-06-06 12:09:55,111 - __main__ - INFO - Request data - Text: Blue t shirt, Image: None
2025-06-06 12:09:55,112 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:09:55,112 - data.model - INFO - Starting recommendation process
2025-06-06 12:09:55,114 - data.model - INFO - Processing text-only input...
2025-06-06 12:09:56,116 - data.model - INFO - Found 10 similar product IDs
2025-06-06 12:09:56,116 - data.model - INFO - Created similar products DataFrame with columns: ['id', 'text', 'score_txt']
2025-06-06 12:09:56,133 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 12:09:56,133 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:09:59,057 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:09:59,456 - data.model - INFO - Found 10 unique complementary products
2025-06-06 12:09:59,457 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 12:09:59,457 - data.model - INFO - Processing final results...
2025-06-06 12:09:59,457 - data.model - INFO - Clearing output directories...
2025-06-06 12:09:59,457 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:09:59,468 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:09:59,468 - data.model - INFO - 
--- Downloading Recommendation Product Images ---
2025-06-06 12:09:59,468 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:09:59,478 - data.model - INFO - Downloading image for Product ID 12703...
2025-06-06 12:10:00,248 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12703.jpg
2025-06-06 12:10:00,249 - data.model - INFO - Downloading image for Product ID 25722...
2025-06-06 12:10:00,424 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25722.jpg
2025-06-06 12:10:00,425 - data.model - INFO - Downloading image for Product ID 12303...
2025-06-06 12:10:01,610 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12303.jpg
2025-06-06 12:10:01,611 - data.model - INFO - Downloading image for Product ID 48147...
2025-06-06 12:10:02,159 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\48147.jpg
2025-06-06 12:10:02,165 - data.model - INFO - Downloading image for Product ID 9189...
2025-06-06 12:10:02,878 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\9189.jpg
2025-06-06 12:10:02,879 - data.model - INFO - Downloading image for Product ID 43649...
2025-06-06 12:10:03,363 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\43649.jpg
2025-06-06 12:10:03,363 - data.model - INFO - Downloading image for Product ID 24447...
2025-06-06 12:10:03,649 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\24447.jpg
2025-06-06 12:10:03,649 - data.model - INFO - Downloading image for Product ID 21331...
2025-06-06 12:10:04,115 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\21331.jpg
2025-06-06 12:10:04,115 - data.model - INFO - Downloading image for Product ID 45675...
2025-06-06 12:10:04,897 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\45675.jpg
2025-06-06 12:10:04,897 - data.model - INFO - Downloading image for Product ID 59984...
2025-06-06 12:10:05,902 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\59984.jpg
2025-06-06 12:10:05,902 - data.model - INFO - 
--- Downloading Similar Product Images ---
2025-06-06 12:10:05,902 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:10:05,902 - data.model - INFO - Downloading image for Product ID 57028...
2025-06-06 12:10:06,828 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\57028.jpg
2025-06-06 12:10:06,828 - data.model - INFO - Downloading image for Product ID 32847...
2025-06-06 12:10:07,435 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\32847.jpg
2025-06-06 12:10:07,445 - data.model - INFO - Downloading image for Product ID 57849...
2025-06-06 12:10:07,738 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\57849.jpg
2025-06-06 12:10:07,754 - data.model - INFO - Downloading image for Product ID 38539...
2025-06-06 12:10:08,056 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\38539.jpg
2025-06-06 12:10:08,056 - data.model - INFO - Downloading image for Product ID 58588...
2025-06-06 12:10:08,663 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\58588.jpg
2025-06-06 12:10:08,663 - data.model - INFO - Downloading image for Product ID 19127...
2025-06-06 12:10:09,656 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\19127.jpg
2025-06-06 12:10:09,656 - data.model - INFO - Downloading image for Product ID 56688...
2025-06-06 12:10:10,101 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\56688.jpg
2025-06-06 12:10:10,101 - data.model - INFO - Downloading image for Product ID 38135...
2025-06-06 12:10:10,774 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\38135.jpg
2025-06-06 12:10:10,774 - data.model - INFO - Downloading image for Product ID 33715...
2025-06-06 12:10:11,540 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\33715.jpg
2025-06-06 12:10:11,540 - data.model - INFO - Downloading image for Product ID 8302...
2025-06-06 12:10:12,180 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\8302.jpg
2025-06-06 12:10:12,180 - data.model - INFO - 
--- Creating products.js file ---
2025-06-06 12:10:12,180 - data.model - INFO - Creating products.js file...
2025-06-06 12:10:12,180 - data.model - INFO - Created 3 base products
2025-06-06 12:10:12,195 - data.model - INFO - Created 10 similar products
2025-06-06 12:10:12,195 - data.model - INFO - Created 10 recommended products
2025-06-06 12:10:12,402 - data.model - INFO - Successfully processed recommendations
2025-06-06 12:10:12,402 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:10:12,402 - __main__ - INFO - Received results from recommender
2025-06-06 12:10:12,402 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:10:12,402 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:10:12,402 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:10:12,402 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:10:12,402 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:10:12,402 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:10:12,402 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:10:12,402 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:10:12,402 - __main__ - INFO - Adding missing column: season
2025-06-06 12:10:12,418 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:10:12,418 - __main__ - INFO - Adding missing column: image
2025-06-06 12:10:12,418 - __main__ - INFO - Adding missing column: price
2025-06-06 12:10:12,418 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:10:12,418 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:10:12,418 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:10:12,418 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:10:12,418 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:10:12,418 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:10:12,418 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:10:12,436 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:10:12,436 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:10:12,436 - __main__ - INFO - Adding missing column: season
2025-06-06 12:10:12,436 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:10:12,436 - __main__ - INFO - Adding missing column: image
2025-06-06 12:10:12,436 - __main__ - INFO - Adding missing column: price
2025-06-06 12:10:12,436 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:10:12,436 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:11:23,073 - __main__ - INFO - Received recommendation request
2025-06-06 12:11:23,078 - __main__ - INFO - Request data - Text: i am looking for a blue t shirt, Image: None
2025-06-06 12:11:23,078 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:11:23,078 - data.model - INFO - Starting recommendation process
2025-06-06 12:11:23,083 - data.model - INFO - Processing text-only input...
2025-06-06 12:11:23,192 - data.model - INFO - Found 10 similar product IDs
2025-06-06 12:11:23,192 - data.model - INFO - Created similar products DataFrame with columns: ['id', 'text', 'score_txt']
2025-06-06 12:11:23,198 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 12:11:23,198 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:11:25,779 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:11:26,216 - data.model - INFO - Found 10 unique complementary products
2025-06-06 12:11:26,216 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 12:11:26,216 - data.model - INFO - Processing final results...
2025-06-06 12:11:26,216 - data.model - INFO - Clearing output directories...
2025-06-06 12:11:26,223 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:11:26,228 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:11:26,228 - data.model - INFO - 
--- Downloading Recommendation Product Images ---
2025-06-06 12:11:26,228 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:11:26,237 - data.model - INFO - Downloading image for Product ID 12703...
2025-06-06 12:11:26,867 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12703.jpg
2025-06-06 12:11:26,869 - data.model - INFO - Downloading image for Product ID 57792...
2025-06-06 12:11:27,417 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\57792.jpg
2025-06-06 12:11:27,420 - data.model - INFO - Downloading image for Product ID 12303...
2025-06-06 12:11:28,339 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12303.jpg
2025-06-06 12:11:28,341 - data.model - INFO - Downloading image for Product ID 48147...
2025-06-06 12:11:28,912 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\48147.jpg
2025-06-06 12:11:28,912 - data.model - INFO - Downloading image for Product ID 43649...
2025-06-06 12:11:29,324 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\43649.jpg
2025-06-06 12:11:29,324 - data.model - INFO - Downloading image for Product ID 20776...
2025-06-06 12:11:29,578 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\20776.jpg
2025-06-06 12:11:29,578 - data.model - INFO - Downloading image for Product ID 25022...
2025-06-06 12:11:30,388 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25022.jpg
2025-06-06 12:11:30,388 - data.model - INFO - Downloading image for Product ID 24447...
2025-06-06 12:11:30,792 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\24447.jpg
2025-06-06 12:11:30,792 - data.model - INFO - Downloading image for Product ID 21331...
2025-06-06 12:11:31,159 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\21331.jpg
2025-06-06 12:11:31,159 - data.model - INFO - Downloading image for Product ID 45675...
2025-06-06 12:11:31,622 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\45675.jpg
2025-06-06 12:11:31,622 - data.model - INFO - 
--- Downloading Similar Product Images ---
2025-06-06 12:11:31,622 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:11:31,622 - data.model - INFO - Downloading image for Product ID 57028...
2025-06-06 12:11:32,229 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\57028.jpg
2025-06-06 12:11:32,229 - data.model - INFO - Downloading image for Product ID 38539...
2025-06-06 12:11:32,802 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\38539.jpg
2025-06-06 12:11:32,802 - data.model - INFO - Downloading image for Product ID 43176...
2025-06-06 12:11:33,057 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\43176.jpg
2025-06-06 12:11:33,057 - data.model - INFO - Downloading image for Product ID 21952...
2025-06-06 12:11:33,472 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\21952.jpg
2025-06-06 12:11:33,476 - data.model - INFO - Downloading image for Product ID 28850...
2025-06-06 12:11:33,758 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\28850.jpg
2025-06-06 12:11:33,758 - data.model - INFO - Downloading image for Product ID 58588...
2025-06-06 12:11:33,966 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\58588.jpg
2025-06-06 12:11:33,966 - data.model - INFO - Downloading image for Product ID 56688...
2025-06-06 12:11:34,486 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\56688.jpg
2025-06-06 12:11:34,486 - data.model - INFO - Downloading image for Product ID 25277...
2025-06-06 12:11:34,995 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\25277.jpg
2025-06-06 12:11:34,995 - data.model - INFO - Downloading image for Product ID 3201...
2025-06-06 12:11:35,711 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\3201.jpg
2025-06-06 12:11:35,711 - data.model - INFO - Downloading image for Product ID 8302...
2025-06-06 12:11:36,534 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\8302.jpg
2025-06-06 12:11:36,534 - data.model - INFO - 
--- Creating products.js file ---
2025-06-06 12:11:36,534 - data.model - INFO - Creating products.js file...
2025-06-06 12:11:36,540 - data.model - INFO - Created 3 base products
2025-06-06 12:11:36,546 - data.model - INFO - Created 10 similar products
2025-06-06 12:11:36,552 - data.model - INFO - Created 10 recommended products
2025-06-06 12:11:36,564 - data.model - INFO - Successfully processed recommendations
2025-06-06 12:11:36,564 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:11:36,564 - __main__ - INFO - Received results from recommender
2025-06-06 12:11:36,566 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:11:36,566 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:11:36,566 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:11:36,566 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:11:36,566 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:11:36,566 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:11:36,566 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:11:36,566 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:11:36,571 - __main__ - INFO - Adding missing column: season
2025-06-06 12:11:36,571 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:11:36,572 - __main__ - INFO - Adding missing column: image
2025-06-06 12:11:36,572 - __main__ - INFO - Adding missing column: price
2025-06-06 12:11:36,572 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:11:36,576 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:11:36,576 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:11:36,577 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:11:36,577 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:11:36,577 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:11:36,577 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:11:36,577 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:11:36,577 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:11:36,582 - __main__ - INFO - Adding missing column: season
2025-06-06 12:11:36,583 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:11:36,583 - __main__ - INFO - Adding missing column: image
2025-06-06 12:11:36,583 - __main__ - INFO - Adding missing column: price
2025-06-06 12:11:36,583 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:11:36,583 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:15:26,898 - __main__ - INFO - Received recommendation request
2025-06-06 12:15:26,903 - __main__ - INFO - Request data - Text: i am looking for a blue t shirt, Image: Present
2025-06-06 12:15:26,903 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:15:26,910 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4971792822147309998.jpg
2025-06-06 12:15:26,910 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:15:26,910 - data.model - INFO - Starting recommendation process
2025-06-06 12:15:26,910 - data.model - INFO - Processing image input...
2025-06-06 12:15:27,763 - data.model - INFO - Processing combined image and text input...
2025-06-06 12:15:27,897 - data.model - INFO - Found 10 similar product IDs
2025-06-06 12:15:27,903 - data.model - INFO - Created similar products DataFrame with columns: ['id', 'text', 'score_img']
2025-06-06 12:15:27,909 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 12:15:27,909 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:15:29,039 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 12:15:34,167 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:15:34,561 - data.model - INFO - Found 10 unique complementary products
2025-06-06 12:15:34,567 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 12:15:34,567 - data.model - INFO - Processing final results...
2025-06-06 12:15:34,567 - data.model - INFO - Clearing output directories...
2025-06-06 12:15:34,576 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:15:34,588 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:15:34,594 - data.model - INFO - 
--- Downloading Recommendation Product Images ---
2025-06-06 12:15:34,594 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:15:34,603 - data.model - INFO - Downloading image for Product ID 12703...
2025-06-06 12:15:37,706 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12703.jpg
2025-06-06 12:15:37,712 - data.model - INFO - Downloading image for Product ID 18638...
2025-06-06 12:15:42,214 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\18638.jpg
2025-06-06 12:15:42,214 - data.model - INFO - Downloading image for Product ID 25722...
2025-06-06 12:15:43,182 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25722.jpg
2025-06-06 12:15:43,182 - data.model - INFO - Downloading image for Product ID 12303...
2025-06-06 12:15:43,852 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12303.jpg
2025-06-06 12:15:43,852 - data.model - INFO - Downloading image for Product ID 48147...
2025-06-06 12:15:44,205 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\48147.jpg
2025-06-06 12:15:44,213 - data.model - INFO - Downloading image for Product ID 25022...
2025-06-06 12:15:44,348 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25022.jpg
2025-06-06 12:15:44,348 - data.model - INFO - Downloading image for Product ID 24447...
2025-06-06 12:15:44,480 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\24447.jpg
2025-06-06 12:15:44,480 - data.model - INFO - Downloading image for Product ID 21331...
2025-06-06 12:15:44,857 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\21331.jpg
2025-06-06 12:15:44,858 - data.model - INFO - Downloading image for Product ID 45675...
2025-06-06 12:15:44,995 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\45675.jpg
2025-06-06 12:15:44,995 - data.model - INFO - Downloading image for Product ID 30255...
2025-06-06 12:15:45,468 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\30255.jpg
2025-06-06 12:15:45,468 - data.model - INFO - 
--- Downloading Similar Product Images ---
2025-06-06 12:15:45,473 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:15:45,480 - data.model - INFO - Downloading image for Product ID 59066...
2025-06-06 12:15:45,922 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\59066.jpg
2025-06-06 12:15:45,922 - data.model - INFO - Downloading image for Product ID 42081...
2025-06-06 12:15:46,195 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\42081.jpg
2025-06-06 12:15:46,195 - data.model - INFO - Downloading image for Product ID 26468...
2025-06-06 12:15:46,458 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\26468.jpg
2025-06-06 12:15:46,458 - data.model - INFO - Downloading image for Product ID 37141...
2025-06-06 12:15:47,062 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\37141.jpg
2025-06-06 12:15:47,068 - data.model - INFO - Downloading image for Product ID 27183...
2025-06-06 12:15:47,480 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\27183.jpg
2025-06-06 12:15:47,480 - data.model - INFO - Downloading image for Product ID 18759...
2025-06-06 12:15:48,231 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\18759.jpg
2025-06-06 12:15:48,231 - data.model - INFO - Downloading image for Product ID 37697...
2025-06-06 12:15:48,740 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\37697.jpg
2025-06-06 12:15:48,740 - data.model - INFO - Downloading image for Product ID 46482...
2025-06-06 12:15:49,025 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\46482.jpg
2025-06-06 12:15:49,025 - data.model - INFO - Downloading image for Product ID 4267...
2025-06-06 12:15:49,624 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\4267.jpg
2025-06-06 12:15:49,626 - data.model - INFO - Downloading image for Product ID 22346...
2025-06-06 12:15:50,103 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\22346.jpg
2025-06-06 12:15:50,104 - data.model - INFO - 
--- Creating products.js file ---
2025-06-06 12:15:50,104 - data.model - INFO - Creating products.js file...
2025-06-06 12:15:50,104 - data.model - INFO - Created 3 base products
2025-06-06 12:15:50,109 - data.model - INFO - Created 10 similar products
2025-06-06 12:15:50,122 - data.model - INFO - Created 10 recommended products
2025-06-06 12:15:50,158 - data.model - INFO - Successfully processed recommendations
2025-06-06 12:15:50,158 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:15:50,158 - __main__ - INFO - Received results from recommender
2025-06-06 12:15:50,158 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:15:50,158 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:15:50,158 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 12:15:50,158 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:15:50,158 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:15:50,158 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:15:50,158 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:15:50,164 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:15:50,166 - __main__ - INFO - Adding missing column: season
2025-06-06 12:15:50,166 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:15:50,166 - __main__ - INFO - Adding missing column: image
2025-06-06 12:15:50,166 - __main__ - INFO - Adding missing column: price
2025-06-06 12:15:50,170 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:15:50,170 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:15:50,170 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:15:50,170 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:15:50,170 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:15:50,170 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:15:50,170 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:15:50,176 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:15:50,178 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:15:50,178 - __main__ - INFO - Adding missing column: season
2025-06-06 12:15:50,178 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:15:50,178 - __main__ - INFO - Adding missing column: image
2025-06-06 12:15:50,178 - __main__ - INFO - Adding missing column: price
2025-06-06 12:15:50,182 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:15:50,182 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:15:50,182 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_4971792822147309998.jpg
2025-06-06 12:24:13,453 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:24:13,474 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:24:13,482 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:24:40,375 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:24:41,668 - data.model - INFO - Using device: cuda
2025-06-06 12:24:41,669 - data.model - INFO - Loading CLIP model...
2025-06-06 12:24:47,371 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:24:47,372 - data.model - INFO - Loading SBERT model...
2025-06-06 12:24:47,376 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:24:54,272 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:24:54,272 - data.model - INFO - Loading BLIP model...
2025-06-06 12:24:59,525 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:24:59,526 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:24:59,526 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:24:59,527 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:24:59,527 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:24:59,528 - data.model - INFO - Loading models...
2025-06-06 12:25:07,776 - data.model - INFO - Models loaded successfully!
2025-06-06 12:25:07,778 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:25:08,091 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:25:08,091 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:25:08,091 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:25:08,092 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:25:08,496 - data.model - INFO - Indexes built successfully!
2025-06-06 12:25:08,517 - data.model - INFO - Loading dataset...
2025-06-06 12:25:08,664 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:25:08,664 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:25:08,664 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:25:08,668 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:25:08,979 - __main__ - INFO - Health check requested
2025-06-06 12:25:37,038 - __main__ - INFO - Received recommendation request
2025-06-06 12:25:37,039 - __main__ - INFO - Request data - Text: show me some blue t shirts, Image: None
2025-06-06 12:25:37,039 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:25:37,039 - data.model - INFO - Starting recommendation process
2025-06-06 12:25:37,040 - data.model - INFO - Processing text-only input...
2025-06-06 12:25:37,794 - data.model - INFO - Found 10 similar product IDs
2025-06-06 12:25:37,795 - data.model - INFO - Created similar products DataFrame with columns: ['id', 'text', 'score_txt']
2025-06-06 12:25:37,799 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 12:25:37,801 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:25:40,427 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:25:40,806 - data.model - INFO - Found 10 unique complementary products
2025-06-06 12:25:40,808 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 12:25:40,808 - data.model - INFO - Processing final results...
2025-06-06 12:25:40,808 - data.model - INFO - Clearing output directories...
2025-06-06 12:25:40,810 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:25:40,812 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:25:40,813 - data.model - INFO - 
--- Downloading Recommendation Product Images ---
2025-06-06 12:25:40,814 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:25:40,819 - data.model - INFO - Downloading image for Product ID 57131...
2025-06-06 12:25:41,369 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\57131.jpg
2025-06-06 12:25:41,370 - data.model - INFO - Downloading image for Product ID 12703...
2025-06-06 12:25:41,813 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12703.jpg
2025-06-06 12:25:41,813 - data.model - INFO - Downloading image for Product ID 57792...
2025-06-06 12:25:41,971 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\57792.jpg
2025-06-06 12:25:41,972 - data.model - INFO - Downloading image for Product ID 25722...
2025-06-06 12:25:42,474 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25722.jpg
2025-06-06 12:25:42,475 - data.model - INFO - Downloading image for Product ID 20776...
2025-06-06 12:25:42,606 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\20776.jpg
2025-06-06 12:25:42,608 - data.model - INFO - Downloading image for Product ID 25022...
2025-06-06 12:25:43,160 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25022.jpg
2025-06-06 12:25:43,161 - data.model - INFO - Downloading image for Product ID 5824...
2025-06-06 12:25:43,763 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\5824.jpg
2025-06-06 12:25:43,765 - data.model - INFO - Downloading image for Product ID 24447...
2025-06-06 12:25:44,245 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\24447.jpg
2025-06-06 12:25:44,245 - data.model - INFO - Downloading image for Product ID 5615...
2025-06-06 12:25:45,066 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\5615.jpg
2025-06-06 12:25:45,067 - data.model - INFO - Downloading image for Product ID 31838...
2025-06-06 12:25:45,510 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\31838.jpg
2025-06-06 12:25:45,512 - data.model - INFO - 
--- Downloading Similar Product Images ---
2025-06-06 12:25:45,513 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:25:45,518 - data.model - INFO - Downloading image for Product ID 20202...
2025-06-06 12:25:46,064 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\20202.jpg
2025-06-06 12:25:46,066 - data.model - INFO - Downloading image for Product ID 53794...
2025-06-06 12:25:46,622 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\53794.jpg
2025-06-06 12:25:46,623 - data.model - INFO - Downloading image for Product ID 31103...
2025-06-06 12:25:47,314 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\31103.jpg
2025-06-06 12:25:47,314 - data.model - INFO - Downloading image for Product ID 43176...
2025-06-06 12:25:57,373 - data.model - ERROR - Failed to download image for 43176: HTTPConnectionPool(host='assets.myntassets.com', port=80): Read timed out. (read timeout=10)
2025-06-06 12:25:57,373 - data.model - INFO - Downloading image for Product ID 28850...
2025-06-06 12:25:57,762 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\28850.jpg
2025-06-06 12:25:57,763 - data.model - INFO - Downloading image for Product ID 58588...
2025-06-06 12:25:57,913 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\58588.jpg
2025-06-06 12:25:57,914 - data.model - INFO - Downloading image for Product ID 56688...
2025-06-06 12:25:58,360 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\56688.jpg
2025-06-06 12:25:58,361 - data.model - INFO - Downloading image for Product ID 43505...
2025-06-06 12:25:58,668 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\43505.jpg
2025-06-06 12:25:58,669 - data.model - INFO - Downloading image for Product ID 25277...
2025-06-06 12:25:59,121 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\25277.jpg
2025-06-06 12:25:59,122 - data.model - INFO - Downloading image for Product ID 39194...
2025-06-06 12:25:59,605 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\39194.jpg
2025-06-06 12:25:59,607 - data.model - INFO - 
--- Creating products.js file ---
2025-06-06 12:25:59,608 - data.model - INFO - Creating products.js file...
2025-06-06 12:25:59,610 - data.model - INFO - Created 3 base products
2025-06-06 12:25:59,620 - data.model - INFO - Created 10 similar products
2025-06-06 12:25:59,628 - data.model - INFO - Created 10 recommended products
2025-06-06 12:25:59,663 - data.model - INFO - Successfully processed recommendations
2025-06-06 12:25:59,663 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:25:59,663 - __main__ - INFO - Received results from recommender
2025-06-06 12:25:59,663 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:25:59,665 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:25:59,666 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:25:59,666 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:25:59,668 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:25:59,669 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:25:59,670 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:25:59,671 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:25:59,672 - __main__ - INFO - Adding missing column: season
2025-06-06 12:25:59,672 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:25:59,673 - __main__ - INFO - Adding missing column: image
2025-06-06 12:25:59,674 - __main__ - INFO - Adding missing column: price
2025-06-06 12:25:59,678 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:25:59,679 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:25:59,679 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:25:59,679 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:25:59,679 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:25:59,680 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:25:59,680 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:25:59,682 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:25:59,682 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:25:59,683 - __main__ - INFO - Adding missing column: season
2025-06-06 12:25:59,683 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:25:59,683 - __main__ - INFO - Adding missing column: image
2025-06-06 12:25:59,685 - __main__ - INFO - Adding missing column: price
2025-06-06 12:25:59,686 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:25:59,686 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:26:45,005 - __main__ - INFO - Received recommendation request
2025-06-06 12:26:45,006 - __main__ - INFO - Request data - Text: show me some blue t shirts, Image: Present
2025-06-06 12:26:45,006 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:26:45,011 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_1338791333951154719.jpg
2025-06-06 12:26:45,011 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:26:45,012 - data.model - INFO - Starting recommendation process
2025-06-06 12:26:45,013 - data.model - INFO - Processing image input...
2025-06-06 12:26:45,775 - data.model - INFO - Processing combined image and text input...
2025-06-06 12:26:45,910 - data.model - INFO - Found 10 similar product IDs
2025-06-06 12:26:45,913 - data.model - INFO - Created similar products DataFrame with columns: ['id', 'text', 'score_img']
2025-06-06 12:26:45,917 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 12:26:45,918 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:26:47,060 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 12:26:49,958 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:26:50,354 - data.model - INFO - Found 10 unique complementary products
2025-06-06 12:26:50,358 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 12:26:50,359 - data.model - INFO - Processing final results...
2025-06-06 12:26:50,359 - data.model - INFO - Clearing output directories...
2025-06-06 12:26:50,363 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:26:50,370 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:26:50,373 - data.model - INFO - 
--- Downloading Recommendation Product Images ---
2025-06-06 12:26:50,374 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 12:26:50,380 - data.model - INFO - Downloading image for Product ID 12703...
2025-06-06 12:26:51,233 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12703.jpg
2025-06-06 12:26:51,233 - data.model - INFO - Downloading image for Product ID 25722...
2025-06-06 12:26:52,116 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\25722.jpg
2025-06-06 12:26:52,118 - data.model - INFO - Downloading image for Product ID 12303...
2025-06-06 12:26:53,945 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12303.jpg
2025-06-06 12:26:53,946 - data.model - INFO - Downloading image for Product ID 48147...
2025-06-06 12:26:54,464 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\48147.jpg
2025-06-06 12:26:54,466 - data.model - INFO - Downloading image for Product ID 14312...
2025-06-06 12:26:55,588 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\14312.jpg
2025-06-06 12:26:55,589 - data.model - INFO - Downloading image for Product ID 24447...
2025-06-06 12:26:56,560 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\24447.jpg
2025-06-06 12:26:56,562 - data.model - INFO - Downloading image for Product ID 21331...
2025-06-06 12:26:57,939 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\21331.jpg
2025-06-06 12:26:57,940 - data.model - INFO - Downloading image for Product ID 45675...
2025-06-06 12:26:58,254 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\45675.jpg
2025-06-06 12:26:58,255 - data.model - INFO - Downloading image for Product ID 11523...
2025-06-06 12:26:59,732 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\11523.jpg
2025-06-06 12:26:59,733 - data.model - INFO - Downloading image for Product ID 37220...
2025-06-06 12:27:00,845 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\37220.jpg
2025-06-06 12:27:00,845 - data.model - INFO - 
--- Downloading Similar Product Images ---
2025-06-06 12:27:00,846 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 12:27:00,850 - data.model - INFO - Downloading image for Product ID 59066...
2025-06-06 12:27:01,761 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\59066.jpg
2025-06-06 12:27:01,762 - data.model - INFO - Downloading image for Product ID 26468...
2025-06-06 12:27:02,981 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\26468.jpg
2025-06-06 12:27:02,983 - data.model - INFO - Downloading image for Product ID 37141...
2025-06-06 12:27:03,246 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\37141.jpg
2025-06-06 12:27:03,247 - data.model - INFO - Downloading image for Product ID 27183...
2025-06-06 12:27:03,538 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\27183.jpg
2025-06-06 12:27:03,539 - data.model - INFO - Downloading image for Product ID 45169...
2025-06-06 12:27:03,780 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\45169.jpg
2025-06-06 12:27:03,783 - data.model - INFO - Downloading image for Product ID 4846...
2025-06-06 12:27:04,030 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\4846.jpg
2025-06-06 12:27:04,031 - data.model - INFO - Downloading image for Product ID 37697...
2025-06-06 12:27:04,174 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\37697.jpg
2025-06-06 12:27:04,175 - data.model - INFO - Downloading image for Product ID 46482...
2025-06-06 12:27:04,315 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\46482.jpg
2025-06-06 12:27:04,316 - data.model - INFO - Downloading image for Product ID 4267...
2025-06-06 12:27:04,734 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\4267.jpg
2025-06-06 12:27:04,736 - data.model - INFO - Downloading image for Product ID 22346...
2025-06-06 12:27:04,853 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\22346.jpg
2025-06-06 12:27:04,855 - data.model - INFO - 
--- Creating products.js file ---
2025-06-06 12:27:04,855 - data.model - INFO - Creating products.js file...
2025-06-06 12:27:04,859 - data.model - INFO - Created 3 base products
2025-06-06 12:27:04,877 - data.model - INFO - Created 10 similar products
2025-06-06 12:27:04,891 - data.model - INFO - Created 10 recommended products
2025-06-06 12:27:04,917 - data.model - INFO - Successfully processed recommendations
2025-06-06 12:27:04,918 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:27:04,919 - __main__ - INFO - Received results from recommender
2025-06-06 12:27:04,919 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:27:04,921 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:27:04,921 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 12:27:04,922 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:27:04,925 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:27:04,927 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:27:04,932 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:27:04,934 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:27:04,935 - __main__ - INFO - Adding missing column: season
2025-06-06 12:27:04,937 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:27:04,939 - __main__ - INFO - Adding missing column: image
2025-06-06 12:27:04,942 - __main__ - INFO - Adding missing column: price
2025-06-06 12:27:04,946 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:27:04,947 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:27:04,948 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:27:04,948 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 12:27:04,949 - __main__ - INFO - Renaming column id to productId
2025-06-06 12:27:04,950 - __main__ - INFO - Renaming column text to productName
2025-06-06 12:27:04,950 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:27:04,953 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:27:04,955 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:27:04,956 - __main__ - INFO - Adding missing column: season
2025-06-06 12:27:04,957 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:27:04,958 - __main__ - INFO - Adding missing column: image
2025-06-06 12:27:04,960 - __main__ - INFO - Adding missing column: price
2025-06-06 12:27:04,964 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:27:04,964 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:27:04,966 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_1338791333951154719.jpg
2025-06-06 12:33:45,463 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:33:45,491 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:33:45,493 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:33:58,275 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:33:58,792 - data.model - INFO - Using device: cuda
2025-06-06 12:33:58,792 - data.model - INFO - Loading CLIP model...
2025-06-06 12:34:04,828 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:34:04,828 - data.model - INFO - Loading SBERT model...
2025-06-06 12:34:04,832 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:34:09,706 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:34:09,706 - data.model - INFO - Loading BLIP model...
2025-06-06 12:34:15,332 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:34:15,332 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:34:15,332 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:34:15,332 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:34:15,332 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:34:15,332 - data.model - INFO - Loading models...
2025-06-06 12:34:25,412 - data.model - INFO - Models loaded successfully!
2025-06-06 12:34:25,414 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:34:25,915 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:34:25,915 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:34:25,915 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:34:25,915 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:34:26,524 - data.model - INFO - Indexes built successfully!
2025-06-06 12:34:26,552 - data.model - INFO - Loading dataset...
2025-06-06 12:34:26,811 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:34:26,812 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:34:26,812 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:34:26,812 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:34:44,083 - __main__ - INFO - Received recommendation request
2025-06-06 12:34:44,085 - __main__ - INFO - Request data - Text: a blue t shirt, Image: None
2025-06-06 12:34:44,085 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:34:44,086 - data.model - INFO - Starting recommendation process
2025-06-06 12:34:44,088 - data.model - INFO - Processing text-only input...
2025-06-06 12:34:45,275 - __main__ - ERROR - Error in process_recommendations: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 402, in recommend
    sim_df = self.df.iloc[It[0]][["id", "text"]].copy()
             ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6249, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
2025-06-06 12:34:54,972 - __main__ - INFO - Received recommendation request
2025-06-06 12:34:54,973 - __main__ - INFO - Request data - Text: a blue t shirt, Image: None
2025-06-06 12:34:54,974 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:34:54,974 - data.model - INFO - Starting recommendation process
2025-06-06 12:34:54,976 - data.model - INFO - Processing text-only input...
2025-06-06 12:34:55,072 - __main__ - ERROR - Error in process_recommendations: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 402, in recommend
    sim_df = self.df.iloc[It[0]][["id", "text"]].copy()
             ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6249, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
2025-06-06 12:35:21,692 - __main__ - INFO - Received recommendation request
2025-06-06 12:35:21,694 - __main__ - INFO - Request data - Text: a blue t shirt, Image: Present
2025-06-06 12:35:21,695 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:35:21,700 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-2210008769757971885.jpg
2025-06-06 12:35:21,706 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:35:21,706 - data.model - INFO - Starting recommendation process
2025-06-06 12:35:21,708 - data.model - INFO - Processing image input...
2025-06-06 12:35:22,438 - data.model - INFO - Processing combined image and text input...
2025-06-06 12:35:22,549 - __main__ - ERROR - Error in process_recommendations: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 392, in recommend
    sim_df = self.df.iloc[Iv[0]][["id", "text"]].copy()
             ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6249, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
2025-06-06 12:38:40,582 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:38:40,608 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:38:40,614 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:38:52,991 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:38:53,512 - data.model - INFO - Using device: cuda
2025-06-06 12:38:53,512 - data.model - INFO - Loading CLIP model...
2025-06-06 12:38:57,142 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:38:57,142 - data.model - INFO - Loading SBERT model...
2025-06-06 12:38:57,142 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:39:01,644 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:39:01,644 - data.model - INFO - Loading BLIP model...
2025-06-06 12:39:06,026 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:39:06,026 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:39:06,026 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:39:06,026 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:39:06,026 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:39:06,026 - data.model - INFO - Loading models...
2025-06-06 12:39:14,212 - data.model - INFO - Models loaded successfully!
2025-06-06 12:39:14,212 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:39:14,512 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:39:14,512 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:39:14,514 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:39:14,515 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:39:14,897 - data.model - INFO - Indexes built successfully!
2025-06-06 12:39:14,912 - data.model - INFO - Loading dataset...
2025-06-06 12:39:15,053 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:39:15,053 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:39:15,053 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:39:15,059 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:39:28,722 - __main__ - INFO - Received recommendation request
2025-06-06 12:39:28,723 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 12:39:28,723 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:39:28,727 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_1918897662002610978.jpg
2025-06-06 12:39:28,729 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:39:28,729 - data.model - INFO - Starting recommendation process
2025-06-06 12:39:28,731 - data.model - INFO - Processing image input...
2025-06-06 12:39:30,323 - data.model - INFO - Processing image-only input...
2025-06-06 12:39:30,384 - __main__ - ERROR - Error in process_recommendations: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 392, in recommend
    sim_df = self.df.iloc[Iv[0]][["id", "text"]].copy()
             ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 6249, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['id', 'text'], dtype='object')] are in the [columns]"
2025-06-06 12:42:46,152 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:42:46,173 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:42:46,185 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:43:07,288 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:43:08,249 - data.model - INFO - Using device: cuda
2025-06-06 12:43:08,250 - data.model - INFO - Loading CLIP model...
2025-06-06 12:43:13,961 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:43:13,962 - data.model - INFO - Loading SBERT model...
2025-06-06 12:43:13,966 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:43:19,486 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:43:19,486 - data.model - INFO - Loading BLIP model...
2025-06-06 12:43:25,996 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:43:25,997 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:43:25,997 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:43:25,998 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:43:25,999 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:43:25,999 - data.model - INFO - Loading models...
2025-06-06 12:43:36,720 - data.model - INFO - Models loaded successfully!
2025-06-06 12:43:36,723 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:43:37,205 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:43:37,205 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:43:37,206 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:43:37,206 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:43:37,779 - data.model - INFO - Indexes built successfully!
2025-06-06 12:43:37,812 - data.model - INFO - Loading dataset...
2025-06-06 12:43:38,131 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:43:38,132 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:43:38,132 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:43:38,139 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:44:46,948 - __main__ - INFO - Received recommendation request
2025-06-06 12:44:46,949 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 12:44:46,950 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:44:46,956 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-5733025723746661953.jpg
2025-06-06 12:44:46,958 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:44:46,958 - data.model - INFO - Starting recommendation process
2025-06-06 12:44:46,961 - data.model - INFO - Processing image input...
2025-06-06 12:44:48,566 - data.model - INFO - Processing image-only input...
2025-06-06 12:44:48,599 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:44:49,754 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 12:44:54,266 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:44:54,786 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:44:54,786 - __main__ - INFO - Received results from recommender
2025-06-06 12:44:54,786 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:44:54,788 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:44:54,788 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_img']
2025-06-06 12:44:54,788 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:44:54,791 - __main__ - INFO - Adding missing column: productName
2025-06-06 12:44:54,791 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:44:54,793 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:44:54,795 - __main__ - INFO - Adding missing column: season
2025-06-06 12:44:54,796 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:44:54,796 - __main__ - INFO - Adding missing column: image
2025-06-06 12:44:54,799 - __main__ - INFO - Adding missing column: price
2025-06-06 12:44:54,806 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:44:54,807 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:44:54,807 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:44:54,809 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_txt']
2025-06-06 12:44:54,810 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:44:54,811 - __main__ - INFO - Adding missing column: productName
2025-06-06 12:44:54,813 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:44:54,813 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:44:54,814 - __main__ - INFO - Adding missing column: season
2025-06-06 12:44:54,815 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:44:54,816 - __main__ - INFO - Adding missing column: image
2025-06-06 12:44:54,818 - __main__ - INFO - Adding missing column: price
2025-06-06 12:44:54,820 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:44:54,821 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:44:54,822 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_-5733025723746661953.jpg
2025-06-06 12:45:29,253 - __main__ - INFO - Received recommendation request
2025-06-06 12:45:29,255 - __main__ - INFO - Request data - Text: show me blue t shirts, Image: Present
2025-06-06 12:45:29,255 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:45:29,263 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-5733025723746661953.jpg
2025-06-06 12:45:29,267 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:45:29,269 - data.model - INFO - Starting recommendation process
2025-06-06 12:45:29,272 - data.model - INFO - Processing image input...
2025-06-06 12:45:29,445 - data.model - INFO - Processing combined image and text input...
2025-06-06 12:45:29,565 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:45:30,281 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 12:45:32,953 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:45:33,331 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:45:33,332 - __main__ - INFO - Received results from recommender
2025-06-06 12:45:33,332 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:45:33,332 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:45:33,332 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_img']
2025-06-06 12:45:33,333 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:45:33,333 - __main__ - INFO - Adding missing column: productName
2025-06-06 12:45:33,335 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:45:33,335 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:45:33,336 - __main__ - INFO - Adding missing column: season
2025-06-06 12:45:33,336 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:45:33,337 - __main__ - INFO - Adding missing column: image
2025-06-06 12:45:33,337 - __main__ - INFO - Adding missing column: price
2025-06-06 12:45:33,340 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:45:33,340 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:45:33,340 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:45:33,340 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_txt']
2025-06-06 12:45:33,342 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:45:33,345 - __main__ - INFO - Adding missing column: productName
2025-06-06 12:45:33,346 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:45:33,347 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:45:33,347 - __main__ - INFO - Adding missing column: season
2025-06-06 12:45:33,348 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:45:33,348 - __main__ - INFO - Adding missing column: image
2025-06-06 12:45:33,350 - __main__ - INFO - Adding missing column: price
2025-06-06 12:45:33,353 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:45:33,354 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:45:33,355 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_-5733025723746661953.jpg
2025-06-06 12:50:27,434 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 12:50:27,530 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 12:50:27,562 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 12:51:47,341 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 12:51:50,671 - data.model - INFO - Using device: cuda
2025-06-06 12:51:50,672 - data.model - INFO - Loading CLIP model...
2025-06-06 12:51:56,760 - data.model - INFO - CLIP model loaded successfully
2025-06-06 12:51:56,761 - data.model - INFO - Loading SBERT model...
2025-06-06 12:51:56,766 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 12:52:05,148 - data.model - INFO - SBERT model loaded successfully
2025-06-06 12:52:05,149 - data.model - INFO - Loading BLIP model...
2025-06-06 12:52:13,390 - data.model - INFO - BLIP model loaded successfully
2025-06-06 12:52:13,391 - data.model - INFO - Configuring Gemini API...
2025-06-06 12:52:13,391 - data.model - INFO - Gemini API configured successfully
2025-06-06 12:52:13,393 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 12:52:13,401 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 12:52:13,401 - data.model - INFO - Loading models...
2025-06-06 12:52:29,089 - data.model - INFO - Models loaded successfully!
2025-06-06 12:52:29,090 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 12:52:30,160 - data.model - INFO - Loaded 39996 products with embeddings
2025-06-06 12:52:30,160 - data.model - INFO - Image embeddings shape: (39996, 512)
2025-06-06 12:52:30,169 - data.model - INFO - Text embeddings shape: (39996, 512)
2025-06-06 12:52:30,169 - data.model - INFO - Building FAISS indexes...
2025-06-06 12:52:31,185 - data.model - INFO - Indexes built successfully!
2025-06-06 12:52:31,229 - data.model - INFO - Loading dataset...
2025-06-06 12:52:31,823 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 12:52:31,823 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 12:52:31,823 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 12:52:31,835 - __main__ - INFO - Starting FastAPI server...
2025-06-06 12:52:43,259 - __main__ - INFO - Received recommendation request
2025-06-06 12:52:43,260 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 12:52:43,261 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 12:52:43,263 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_6014270878211730992.jpg
2025-06-06 12:52:43,266 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 12:52:43,268 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_6014270878211730992.jpg, prompt: None
2025-06-06 12:52:43,269 - data.model - INFO - Processing image input...
2025-06-06 12:52:46,131 - data.model - INFO - Processing image-only input...
2025-06-06 12:52:46,263 - data.model - INFO - Similar product IDs: ['27183', '18759', '26468', '22346', '37141', '4267', '37697', '59066', '19823', '33414']
2025-06-06 12:52:46,264 - data.model - INFO - Generating complementary recommendations...
2025-06-06 12:52:48,387 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 12:52:53,361 - data.model - INFO - Generated 5 complementary categories
2025-06-06 12:52:54,118 - data.model - INFO - Recommended product IDs: ['11077', '48619', '12703', '12303', '48147', '11027', '21331', '45675', '33923', '24447']
2025-06-06 12:52:54,119 - data.model - INFO - Recommendation process completed successfully
2025-06-06 12:52:54,119 - __main__ - INFO - Received results from recommender
2025-06-06 12:52:54,120 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 12:52:54,121 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:52:54,121 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_img']
2025-06-06 12:52:54,122 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:52:54,127 - __main__ - INFO - Adding missing column: productName
2025-06-06 12:52:54,130 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:52:54,131 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:52:54,133 - __main__ - INFO - Adding missing column: season
2025-06-06 12:52:54,134 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:52:54,135 - __main__ - INFO - Adding missing column: image
2025-06-06 12:52:54,141 - __main__ - INFO - Adding missing column: price
2025-06-06 12:52:54,153 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:52:54,154 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 12:52:54,155 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 12:52:54,155 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_txt']
2025-06-06 12:52:54,156 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 12:52:54,160 - __main__ - INFO - Adding missing column: productName
2025-06-06 12:52:54,162 - __main__ - INFO - Adding missing column: articleType
2025-06-06 12:52:54,164 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 12:52:54,165 - __main__ - INFO - Adding missing column: season
2025-06-06 12:52:54,167 - __main__ - INFO - Adding missing column: usage
2025-06-06 12:52:54,168 - __main__ - INFO - Adding missing column: image
2025-06-06 12:52:54,170 - __main__ - INFO - Adding missing column: price
2025-06-06 12:52:54,178 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 12:52:54,179 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 12:52:54,180 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_6014270878211730992.jpg
2025-06-06 13:06:43,049 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 13:06:43,116 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 13:06:43,141 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 13:07:27,823 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 13:07:29,283 - data.model - INFO - Using device: cuda
2025-06-06 13:07:29,283 - data.model - INFO - Loading CLIP model...
2025-06-06 13:07:34,827 - data.model - INFO - CLIP model loaded successfully
2025-06-06 13:07:34,827 - data.model - INFO - Loading SBERT model...
2025-06-06 13:07:34,835 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 13:07:41,765 - data.model - INFO - SBERT model loaded successfully
2025-06-06 13:07:41,765 - data.model - INFO - Loading BLIP model...
2025-06-06 13:07:48,308 - data.model - INFO - BLIP model loaded successfully
2025-06-06 13:07:48,310 - data.model - INFO - Configuring Gemini API...
2025-06-06 13:07:48,310 - data.model - INFO - Gemini API configured successfully
2025-06-06 13:07:48,312 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 13:07:48,312 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 13:07:48,313 - data.model - INFO - Loading models...
2025-06-06 13:08:00,573 - data.model - INFO - Models loaded successfully!
2025-06-06 13:08:00,575 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 13:08:00,682 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 13:08:00,685 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 13:08:00,686 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 13:08:00,688 - data.model - INFO - Building FAISS indexes...
2025-06-06 13:08:00,791 - data.model - INFO - Indexes built successfully!
2025-06-06 13:08:00,797 - data.model - INFO - Loading dataset...
2025-06-06 13:08:01,249 - data.model - INFO - DF shape: (44445, 11)
2025-06-06 13:08:01,308 - data.model - INFO - DF head:   productId gender  ...                                               link price
0     15970    Men  ...  http://assets.myntassets.com/v1/images/style/p...   842
1     39386    Men  ...  http://assets.myntassets.com/v1/images/style/p...  1531
2     21379    Men  ...  http://assets.myntassets.com/v1/images/style/p...  1882
3     53759    Men  ...  http://assets.myntassets.com/v1/images/style/p...   882
4      1855    Men  ...  http://assets.myntassets.com/v1/images/style/p...  1085

[5 rows x 11 columns]

2025-06-06 13:08:01,308 - data.model - INFO - DF columns: ['productId', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'usage', 'productDisplayName', 'link', 'price']
2025-06-06 13:08:01,308 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 13:08:01,309 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 13:08:01,309 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 13:08:01,322 - __main__ - INFO - Starting FastAPI server...
2025-06-06 13:08:17,428 - __main__ - INFO - Received recommendation request
2025-06-06 13:08:17,429 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 13:08:17,429 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 13:08:17,435 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_3757625857215416941.jpg
2025-06-06 13:08:17,436 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 13:08:17,437 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_3757625857215416941.jpg, prompt: None
2025-06-06 13:08:17,439 - data.model - INFO - Processing image input...
2025-06-06 13:08:19,041 - data.model - INFO - Processing image-only input...
2025-06-06 13:08:19,122 - data.model - INFO - Similar product IDs: ['59066', '26152', '42081', '30036', '45203', '35971', '42017', '4171', '20234', '27475']
2025-06-06 13:08:19,124 - data.model - INFO - Generating complementary recommendations...
2025-06-06 13:08:20,248 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 13:08:25,219 - data.model - INFO - Generated 5 complementary categories
2025-06-06 13:08:25,661 - data.model - INFO - Recommended product IDs: ['12703', '12303', '18638', '57131', '48329', '57792', '25722', '24409', '3700', '35912']
2025-06-06 13:08:25,662 - data.model - INFO - Recommendation process completed successfully
2025-06-06 13:08:25,663 - __main__ - INFO - Received results from recommender
2025-06-06 13:08:25,663 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 13:08:25,664 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 13:08:25,664 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_img']
2025-06-06 13:08:25,664 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 13:08:25,668 - __main__ - INFO - Adding missing column: productName
2025-06-06 13:08:25,669 - __main__ - INFO - Adding missing column: articleType
2025-06-06 13:08:25,670 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 13:08:25,670 - __main__ - INFO - Adding missing column: season
2025-06-06 13:08:25,671 - __main__ - INFO - Adding missing column: usage
2025-06-06 13:08:25,672 - __main__ - INFO - Adding missing column: image
2025-06-06 13:08:25,673 - __main__ - INFO - Adding missing column: price
2025-06-06 13:08:25,679 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 13:08:25,680 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 13:08:25,680 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 13:08:25,680 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_txt']
2025-06-06 13:08:25,681 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 13:08:25,683 - __main__ - INFO - Adding missing column: productName
2025-06-06 13:08:25,686 - __main__ - INFO - Adding missing column: articleType
2025-06-06 13:08:25,687 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 13:08:25,687 - __main__ - INFO - Adding missing column: season
2025-06-06 13:08:25,689 - __main__ - INFO - Adding missing column: usage
2025-06-06 13:08:25,690 - __main__ - INFO - Adding missing column: image
2025-06-06 13:08:25,692 - __main__ - INFO - Adding missing column: price
2025-06-06 13:08:25,694 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 13:08:25,694 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 13:08:25,695 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_3757625857215416941.jpg
2025-06-06 15:37:43,918 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 15:37:44,413 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 15:37:44,447 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 15:39:16,806 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 15:39:18,172 - data.model - INFO - Using device: cuda
2025-06-06 15:39:18,172 - data.model - INFO - Loading CLIP model...
2025-06-06 15:39:24,057 - data.model - INFO - CLIP model loaded successfully
2025-06-06 15:39:24,058 - data.model - INFO - Loading SBERT model...
2025-06-06 15:39:24,064 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 15:39:30,043 - data.model - INFO - SBERT model loaded successfully
2025-06-06 15:39:30,044 - data.model - INFO - Loading BLIP model...
2025-06-06 15:39:37,248 - data.model - INFO - BLIP model loaded successfully
2025-06-06 15:39:37,248 - data.model - INFO - Configuring Gemini API...
2025-06-06 15:39:37,249 - data.model - INFO - Gemini API configured successfully
2025-06-06 15:39:37,251 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 15:39:37,251 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 15:39:37,251 - data.model - INFO - Loading models...
2025-06-06 15:39:49,931 - data.model - INFO - Models loaded successfully!
2025-06-06 15:39:49,932 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 15:39:50,005 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 15:39:50,006 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 15:39:50,008 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 15:39:50,008 - data.model - INFO - Building FAISS indexes...
2025-06-06 15:39:50,111 - data.model - INFO - Indexes built successfully!
2025-06-06 15:39:50,118 - data.model - INFO - Loading dataset...
2025-06-06 15:39:50,207 - data.model - INFO - DF shape: (5000, 12)
2025-06-06 15:39:50,265 - data.model - INFO - DF head:       id  ...                                               text
0  15970  ...          Casual | Turtle Check Men Navy Blue Shirt
1  39386  ...        Casual | Peter England Men Party Blue Jeans
2  59263  ...                  Casual | Titan Women Silver Watch
3  21379  ...  Casual | Manchester United Men Solid Black Tra...
4  53759  ...                     Casual | Puma Men Grey T-shirt

[5 rows x 12 columns]

2025-06-06 15:39:50,266 - data.model - INFO - DF columns: ['id', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text']
2025-06-06 15:39:50,266 - data.model - INFO - Dataset loaded with 5000 records
2025-06-06 15:39:50,266 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 15:39:50,267 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 15:39:50,279 - __main__ - INFO - Starting FastAPI server...
2025-06-06 15:40:07,788 - __main__ - INFO - Received recommendation request
2025-06-06 15:40:07,789 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 15:40:07,789 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 15:40:07,793 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:40:07,793 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:40:07,794 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg, prompt: None
2025-06-06 15:40:07,795 - data.model - INFO - Processing image input...
2025-06-06 15:40:09,876 - data.model - INFO - Processing image-only input...
2025-06-06 15:40:09,967 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 15:40:09,968 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:40:11,409 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 15:40:15,949 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:40:16,380 - data.model - INFO - Recommended product IDs: ['54516', '54517', '54542', '16537', '54526', '54521', '46215', '25715', '25712', '4549']
2025-06-06 15:40:16,380 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:40:16,381 - __main__ - INFO - Received results from recommender
2025-06-06 15:40:16,381 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:40:16,381 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:40:16,382 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:40:16,382 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:40:16,384 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:40:16,384 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:40:16,388 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:40:16,388 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:40:16,389 - __main__ - INFO - Adding missing column: season
2025-06-06 15:40:16,393 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:40:16,394 - __main__ - INFO - Adding missing column: image
2025-06-06 15:40:16,397 - __main__ - INFO - Adding missing column: price
2025-06-06 15:40:16,404 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:40:16,405 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:40:16,405 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:40:16,406 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:40:16,406 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:40:16,407 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:40:16,409 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:40:16,411 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:40:16,412 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:40:16,413 - __main__ - INFO - Adding missing column: season
2025-06-06 15:40:16,414 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:40:16,417 - __main__ - INFO - Adding missing column: image
2025-06-06 15:40:16,419 - __main__ - INFO - Adding missing column: price
2025-06-06 15:40:16,424 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:40:16,426 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:40:16,429 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:40:55,443 - __main__ - INFO - Received recommendation request
2025-06-06 15:40:55,444 - __main__ - INFO - Request data - Text: Blue t shirts, Image: Present
2025-06-06 15:40:55,445 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 15:40:55,449 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:40:55,451 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:40:55,452 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg, prompt: Blue t shirts
2025-06-06 15:40:55,454 - data.model - INFO - Processing image input...
2025-06-06 15:40:55,629 - data.model - INFO - Processing combined image and text input...
2025-06-06 15:40:55,716 - data.model - INFO - Similar product IDs: ['15349', '14001', '2274', '2272', '10490', '7535', '14037', '43506', '10430', '3730']
2025-06-06 15:40:55,718 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:40:56,616 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 15:40:59,481 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:40:59,838 - data.model - INFO - Recommended product IDs: ['26536', '11517', '24260', '13073', '30233', '54516', '54517', '26539', '24258', '13081']
2025-06-06 15:40:59,839 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:40:59,840 - __main__ - INFO - Received results from recommender
2025-06-06 15:40:59,840 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:40:59,841 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:40:59,841 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:40:59,842 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:40:59,843 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:40:59,844 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:40:59,847 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:40:59,848 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:40:59,850 - __main__ - INFO - Adding missing column: season
2025-06-06 15:40:59,851 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:40:59,853 - __main__ - INFO - Adding missing column: image
2025-06-06 15:40:59,854 - __main__ - INFO - Adding missing column: price
2025-06-06 15:40:59,861 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:40:59,862 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:40:59,862 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:40:59,863 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:40:59,863 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:40:59,864 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:40:59,867 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:40:59,869 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:40:59,872 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:40:59,873 - __main__ - INFO - Adding missing column: season
2025-06-06 15:40:59,874 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:40:59,875 - __main__ - INFO - Adding missing column: image
2025-06-06 15:40:59,879 - __main__ - INFO - Adding missing column: price
2025-06-06 15:40:59,886 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:40:59,886 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:40:59,889 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:41:33,345 - __main__ - INFO - Received recommendation request
2025-06-06 15:41:33,346 - __main__ - INFO - Request data - Text: Handbags, Image: Present
2025-06-06 15:41:33,346 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 15:41:33,347 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:41:33,348 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:41:33,348 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg, prompt: Handbags
2025-06-06 15:41:33,349 - data.model - INFO - Processing image input...
2025-06-06 15:41:33,474 - data.model - INFO - Processing combined image and text input...
2025-06-06 15:41:33,542 - data.model - INFO - Similar product IDs: ['3731', '15349', '3730', '2274', '14001', '14006', '10602', '1897', '14038', '14000']
2025-06-06 15:41:33,543 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:41:34,378 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 15:41:38,289 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:41:38,619 - data.model - INFO - Recommended product IDs: ['54516', '26536', '54517', '4125', '54542', '2672', '20895', '24260', '13073', '30233']
2025-06-06 15:41:38,621 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:41:38,621 - __main__ - INFO - Received results from recommender
2025-06-06 15:41:38,621 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:41:38,622 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:41:38,622 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:41:38,622 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:41:38,623 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:41:38,624 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:41:38,628 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:41:38,629 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:41:38,629 - __main__ - INFO - Adding missing column: season
2025-06-06 15:41:38,632 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:41:38,633 - __main__ - INFO - Adding missing column: image
2025-06-06 15:41:38,635 - __main__ - INFO - Adding missing column: price
2025-06-06 15:41:38,640 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:41:38,641 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:41:38,641 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:41:38,642 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:41:38,645 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:41:38,646 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:41:38,647 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:41:38,650 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:41:38,651 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:41:38,652 - __main__ - INFO - Adding missing column: season
2025-06-06 15:41:38,653 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:41:38,653 - __main__ - INFO - Adding missing column: image
2025-06-06 15:41:38,656 - __main__ - INFO - Adding missing column: price
2025-06-06 15:41:38,661 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:41:38,661 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:41:38,663 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:41:47,188 - __main__ - INFO - Received recommendation request
2025-06-06 15:41:47,189 - __main__ - INFO - Request data - Text: handbags, Image: Present
2025-06-06 15:41:47,189 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 15:41:47,191 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:41:47,191 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:41:47,196 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg, prompt: handbags
2025-06-06 15:41:47,198 - data.model - INFO - Processing image input...
2025-06-06 15:41:47,324 - data.model - INFO - Processing combined image and text input...
2025-06-06 15:41:47,405 - data.model - INFO - Similar product IDs: ['3731', '15349', '3730', '2274', '14001', '14006', '10602', '1897', '14038', '14000']
2025-06-06 15:41:47,406 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:41:48,299 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 15:41:53,776 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:41:54,104 - data.model - INFO - Recommended product IDs: ['2672', '47136', '47957', '47131', '47366', '47393', '38434', '37418', '34892', '58179']
2025-06-06 15:41:54,104 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:41:54,105 - __main__ - INFO - Received results from recommender
2025-06-06 15:41:54,106 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:41:54,106 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:41:54,106 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:41:54,106 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:41:54,108 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:41:54,109 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:41:54,113 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:41:54,114 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:41:54,115 - __main__ - INFO - Adding missing column: season
2025-06-06 15:41:54,115 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:41:54,116 - __main__ - INFO - Adding missing column: image
2025-06-06 15:41:54,119 - __main__ - INFO - Adding missing column: price
2025-06-06 15:41:54,125 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:41:54,125 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:41:54,125 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:41:54,125 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:41:54,126 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:41:54,126 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:41:54,126 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:41:54,129 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:41:54,131 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:41:54,132 - __main__ - INFO - Adding missing column: season
2025-06-06 15:41:54,132 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:41:54,133 - __main__ - INFO - Adding missing column: image
2025-06-06 15:41:54,140 - __main__ - INFO - Adding missing column: price
2025-06-06 15:41:54,150 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:41:54,151 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:41:54,152 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_7879302046410666232.jpg
2025-06-06 15:42:03,351 - __main__ - INFO - Received recommendation request
2025-06-06 15:42:03,351 - __main__ - INFO - Request data - Text: handbags, Image: Present
2025-06-06 15:42:03,353 - __main__ - INFO - First 100 chars of base64 image: /9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOJaHR0cDovL25zLmFkb2JlLmNvbS94YXAv
2025-06-06 15:42:03,355 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_3475904491296377621.jpg
2025-06-06 15:42:03,356 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:42:03,356 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_3475904491296377621.jpg, prompt: handbags
2025-06-06 15:42:03,358 - data.model - INFO - Processing image input...
2025-06-06 15:42:03,474 - data.model - INFO - Processing combined image and text input...
2025-06-06 15:42:03,544 - data.model - INFO - Similar product IDs: ['27884', '27885', '42847', '42878', '47131', '42640', '14805', '47303', '47368', '32597']
2025-06-06 15:42:03,545 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:42:04,650 - data.model - INFO - Generated caption: a woman wearing a black cardigan jacket
2025-06-06 15:42:08,083 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:42:08,414 - data.model - INFO - Recommended product IDs: ['47368', '52648', '52647', '3398', '27682', '37421', '42840', '47351', '47303', '38435']
2025-06-06 15:42:08,415 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:42:08,415 - __main__ - INFO - Received results from recommender
2025-06-06 15:42:08,416 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:42:08,416 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:42:08,417 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:42:08,417 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:42:08,419 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:42:08,419 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:42:08,421 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:42:08,422 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:42:08,427 - __main__ - INFO - Adding missing column: season
2025-06-06 15:42:08,427 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:42:08,428 - __main__ - INFO - Adding missing column: image
2025-06-06 15:42:08,431 - __main__ - INFO - Adding missing column: price
2025-06-06 15:42:08,435 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:42:08,435 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:42:08,436 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:42:08,437 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:42:08,437 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:42:08,438 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:42:08,439 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:42:08,443 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:42:08,444 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:42:08,445 - __main__ - INFO - Adding missing column: season
2025-06-06 15:42:08,445 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:42:08,446 - __main__ - INFO - Adding missing column: image
2025-06-06 15:42:08,447 - __main__ - INFO - Adding missing column: price
2025-06-06 15:42:08,453 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:42:08,454 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:42:08,455 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_3475904491296377621.jpg
2025-06-06 15:42:21,811 - __main__ - INFO - Received recommendation request
2025-06-06 15:42:21,811 - __main__ - INFO - Request data - Text: handbags, Image: Present
2025-06-06 15:42:21,812 - __main__ - INFO - First 100 chars of base64 image: /9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAVQAA/+4ADkFkb2JlAGTAAAAAAf/bAIQAAgEBAQEBAgEBAgMCAQID
2025-06-06 15:42:21,815 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-3789579329330868757.jpg
2025-06-06 15:42:21,816 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:42:21,818 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_-3789579329330868757.jpg, prompt: handbags
2025-06-06 15:42:21,819 - data.model - INFO - Processing image input...
2025-06-06 15:42:22,195 - data.model - INFO - Processing combined image and text input...
2025-06-06 15:42:22,267 - data.model - INFO - Similar product IDs: ['26536', '54517', '44783', '54544', '11517', '54529', '13679', '54516', '39988', '13072']
2025-06-06 15:42:22,269 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:42:25,223 - data.model - INFO - Generated caption: re re re re re re re re re re re re re re re re re re re re re re re re re re re re
2025-06-06 15:42:28,428 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:42:28,778 - data.model - INFO - Recommended product IDs: ['54174', '54172', '54175', '40580', '39726', '3135', '9463', '9464', '46283', '48345']
2025-06-06 15:42:28,778 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:42:28,778 - __main__ - INFO - Received results from recommender
2025-06-06 15:42:28,779 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:42:28,779 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:42:28,779 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:42:28,779 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:42:28,781 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:42:28,784 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:42:28,788 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:42:28,791 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:42:28,791 - __main__ - INFO - Adding missing column: season
2025-06-06 15:42:28,792 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:42:28,793 - __main__ - INFO - Adding missing column: image
2025-06-06 15:42:28,796 - __main__ - INFO - Adding missing column: price
2025-06-06 15:42:28,800 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:42:28,802 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:42:28,802 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:42:28,802 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:42:28,803 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:42:28,804 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:42:28,805 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:42:28,809 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:42:28,811 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:42:28,812 - __main__ - INFO - Adding missing column: season
2025-06-06 15:42:28,814 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:42:28,816 - __main__ - INFO - Adding missing column: image
2025-06-06 15:42:28,818 - __main__ - INFO - Adding missing column: price
2025-06-06 15:42:28,824 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:42:28,825 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:42:28,827 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_-3789579329330868757.jpg
2025-06-06 15:42:55,950 - __main__ - INFO - Received recommendation request
2025-06-06 15:42:55,951 - __main__ - INFO - Request data - Text: handbags, Image: Present
2025-06-06 15:42:55,951 - __main__ - INFO - First 100 chars of base64 image: /9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOJaHR0cDovL25zLmFkb2JlLmNvbS94YXAv
2025-06-06 15:42:55,955 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_3475904491296377621.jpg
2025-06-06 15:42:55,956 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:42:55,957 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_3475904491296377621.jpg, prompt: handbags
2025-06-06 15:42:55,959 - data.model - INFO - Processing image input...
2025-06-06 15:42:56,121 - data.model - INFO - Processing combined image and text input...
2025-06-06 15:42:56,203 - data.model - INFO - Similar product IDs: ['27884', '27885', '42847', '42878', '47131', '42640', '14805', '47303', '47368', '32597']
2025-06-06 15:42:56,204 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:42:57,258 - data.model - INFO - Generated caption: a woman wearing a black cardigan jacket
2025-06-06 15:43:00,187 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:43:00,565 - data.model - INFO - Recommended product IDs: ['47368', '52648', '52647', '3398', '27682', '37421', '42840', '47351', '47303', '38435']
2025-06-06 15:43:00,566 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:43:00,566 - __main__ - INFO - Received results from recommender
2025-06-06 15:43:00,566 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:43:00,567 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:43:00,567 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:43:00,568 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:43:00,569 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:43:00,571 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:43:00,574 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:43:00,576 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:43:00,577 - __main__ - INFO - Adding missing column: season
2025-06-06 15:43:00,579 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:43:00,580 - __main__ - INFO - Adding missing column: image
2025-06-06 15:43:00,583 - __main__ - INFO - Adding missing column: price
2025-06-06 15:43:00,588 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:43:00,589 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:43:00,589 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:43:00,591 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:43:00,592 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:43:00,593 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:43:00,594 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:43:00,599 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:43:00,599 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:43:00,601 - __main__ - INFO - Adding missing column: season
2025-06-06 15:43:00,603 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:43:00,605 - __main__ - INFO - Adding missing column: image
2025-06-06 15:43:00,607 - __main__ - INFO - Adding missing column: price
2025-06-06 15:43:00,612 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:43:00,613 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:43:00,615 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_3475904491296377621.jpg
2025-06-06 15:45:39,731 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 15:45:39,808 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 15:45:39,836 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 15:46:26,246 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 15:46:27,434 - data.model - INFO - Using device: cuda
2025-06-06 15:46:27,434 - data.model - INFO - Loading CLIP model...
2025-06-06 15:46:32,958 - data.model - INFO - CLIP model loaded successfully
2025-06-06 15:46:32,959 - data.model - INFO - Loading SBERT model...
2025-06-06 15:46:32,963 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 15:46:38,702 - data.model - INFO - SBERT model loaded successfully
2025-06-06 15:46:38,703 - data.model - INFO - Loading BLIP model...
2025-06-06 15:46:45,359 - data.model - INFO - BLIP model loaded successfully
2025-06-06 15:46:45,360 - data.model - INFO - Configuring Gemini API...
2025-06-06 15:46:45,360 - data.model - INFO - Gemini API configured successfully
2025-06-06 15:46:45,362 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 15:46:45,363 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 15:46:45,363 - data.model - INFO - Loading models...
2025-06-06 15:46:57,919 - data.model - INFO - Models loaded successfully!
2025-06-06 15:46:57,919 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 15:46:57,963 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 15:46:57,965 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 15:46:57,965 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 15:46:57,966 - data.model - INFO - Building FAISS indexes...
2025-06-06 15:46:58,052 - data.model - INFO - Indexes built successfully!
2025-06-06 15:46:58,057 - data.model - INFO - Loading dataset...
2025-06-06 15:46:58,126 - data.model - INFO - DF shape: (5000, 12)
2025-06-06 15:46:58,165 - data.model - INFO - DF head:       id  ...                                               text
0  15970  ...          Casual | Turtle Check Men Navy Blue Shirt
1  39386  ...        Casual | Peter England Men Party Blue Jeans
2  59263  ...                  Casual | Titan Women Silver Watch
3  21379  ...  Casual | Manchester United Men Solid Black Tra...
4  53759  ...                     Casual | Puma Men Grey T-shirt

[5 rows x 12 columns]

2025-06-06 15:46:58,166 - data.model - INFO - DF columns: ['id', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text']
2025-06-06 15:46:58,166 - data.model - INFO - Dataset loaded with 5000 records
2025-06-06 15:46:58,166 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 15:46:58,167 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 15:46:58,179 - __main__ - INFO - Starting FastAPI server...
2025-06-06 15:47:12,541 - __main__ - INFO - Received recommendation request
2025-06-06 15:47:12,542 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 15:47:12,543 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 15:47:12,547 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_8465326344784948033.jpg
2025-06-06 15:47:12,547 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:47:12,547 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_8465326344784948033.jpg, prompt: None
2025-06-06 15:47:12,548 - data.model - INFO - Processing image input...
2025-06-06 15:47:14,729 - data.model - INFO - Processing image-only input...
2025-06-06 15:47:14,830 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 15:47:14,830 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:47:16,314 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 15:47:20,682 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:47:21,145 - data.model - INFO - Recommended product IDs: ['26536', '54516', '54517', '13073', '30233', '24260', '11517', '20895', '54542', '26539']
2025-06-06 15:47:21,146 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:47:21,146 - __main__ - INFO - Received results from recommender
2025-06-06 15:47:21,146 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:47:21,147 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:47:21,148 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:47:21,149 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:47:21,151 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:47:21,152 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:47:21,156 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:47:21,157 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:47:21,158 - __main__ - INFO - Adding missing column: season
2025-06-06 15:47:21,161 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:47:21,162 - __main__ - INFO - Adding missing column: image
2025-06-06 15:47:21,165 - __main__ - INFO - Adding missing column: price
2025-06-06 15:47:21,175 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:47:21,176 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:47:21,176 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:47:21,177 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:47:21,179 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:47:21,180 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:47:21,182 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:47:21,186 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:47:21,188 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:47:21,188 - __main__ - INFO - Adding missing column: season
2025-06-06 15:47:21,192 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:47:21,193 - __main__ - INFO - Adding missing column: image
2025-06-06 15:47:21,197 - __main__ - INFO - Adding missing column: price
2025-06-06 15:47:21,205 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:47:21,205 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:47:21,207 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_8465326344784948033.jpg
2025-06-06 15:47:51,783 - __main__ - INFO - Received recommendation request
2025-06-06 15:47:51,784 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 15:47:51,785 - __main__ - INFO - First 100 chars of base64 image: /9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOJaHR0cDovL25zLmFkb2JlLmNvbS94YXAv
2025-06-06 15:47:51,794 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_1168597591325456873.jpg
2025-06-06 15:47:51,795 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:47:51,796 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_1168597591325456873.jpg, prompt: None
2025-06-06 15:47:51,798 - data.model - INFO - Processing image input...
2025-06-06 15:47:52,007 - data.model - INFO - Processing image-only input...
2025-06-06 15:47:52,015 - data.model - INFO - Similar product IDs: ['25915', '21142', '21173', '11379', '35940', '25912', '19585', '12154', '10406', '37223']
2025-06-06 15:47:52,016 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:47:53,055 - data.model - INFO - Generated caption: a woman wearing a black cardigan jacket
2025-06-06 15:47:56,143 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:47:56,478 - data.model - INFO - Recommended product IDs: ['39974', '39973', '12509', '12508', '52648', '52647', '30693', '49609', '30692', '49607']
2025-06-06 15:47:56,478 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:47:56,479 - __main__ - INFO - Received results from recommender
2025-06-06 15:47:56,479 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:47:56,479 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:47:56,479 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:47:56,481 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:47:56,482 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:47:56,484 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:47:56,486 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:47:56,487 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:47:56,488 - __main__ - INFO - Adding missing column: season
2025-06-06 15:47:56,489 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:47:56,490 - __main__ - INFO - Adding missing column: image
2025-06-06 15:47:56,492 - __main__ - INFO - Adding missing column: price
2025-06-06 15:47:56,495 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:47:56,496 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:47:56,496 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:47:56,497 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:47:56,498 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:47:56,498 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:47:56,499 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:47:56,501 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:47:56,502 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:47:56,503 - __main__ - INFO - Adding missing column: season
2025-06-06 15:47:56,505 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:47:56,508 - __main__ - INFO - Adding missing column: image
2025-06-06 15:47:56,511 - __main__ - INFO - Adding missing column: price
2025-06-06 15:47:56,516 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:47:56,516 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:47:56,518 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_1168597591325456873.jpg
2025-06-06 15:49:41,320 - __main__ - INFO - Received recommendation request
2025-06-06 15:49:41,320 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 15:49:41,321 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 15:49:41,322 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_8465326344784948033.jpg
2025-06-06 15:49:41,323 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 15:49:41,323 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_8465326344784948033.jpg, prompt: None
2025-06-06 15:49:41,324 - data.model - INFO - Processing image input...
2025-06-06 15:49:41,454 - data.model - INFO - Processing image-only input...
2025-06-06 15:49:41,463 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 15:49:41,464 - data.model - INFO - Generating complementary recommendations...
2025-06-06 15:49:42,404 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 15:49:45,580 - data.model - INFO - Generated 5 complementary categories
2025-06-06 15:49:45,911 - data.model - INFO - Recommended product IDs: ['26536', '54516', '54517', '13073', '30233', '24260', '11517', '20895', '54542', '26539']
2025-06-06 15:49:45,913 - data.model - INFO - Recommendation process completed successfully
2025-06-06 15:49:45,914 - __main__ - INFO - Received results from recommender
2025-06-06 15:49:45,914 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 15:49:45,914 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:49:45,914 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 15:49:45,916 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:49:45,916 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:49:45,916 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:49:45,919 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:49:45,920 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:49:45,921 - __main__ - INFO - Adding missing column: season
2025-06-06 15:49:45,921 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:49:45,922 - __main__ - INFO - Adding missing column: image
2025-06-06 15:49:45,923 - __main__ - INFO - Adding missing column: price
2025-06-06 15:49:45,929 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:49:45,929 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 15:49:45,929 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 15:49:45,930 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 15:49:45,931 - __main__ - INFO - Renaming column id to productId
2025-06-06 15:49:45,933 - __main__ - INFO - Renaming column text to productName
2025-06-06 15:49:45,934 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 15:49:45,937 - __main__ - INFO - Adding missing column: articleType
2025-06-06 15:49:45,938 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 15:49:45,939 - __main__ - INFO - Adding missing column: season
2025-06-06 15:49:45,939 - __main__ - INFO - Adding missing column: usage
2025-06-06 15:49:45,940 - __main__ - INFO - Adding missing column: image
2025-06-06 15:49:45,942 - __main__ - INFO - Adding missing column: price
2025-06-06 15:49:45,948 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 15:49:45,949 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 15:49:45,953 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_8465326344784948033.jpg
2025-06-06 16:13:07,373 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 16:13:07,440 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 16:13:07,459 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 16:13:49,963 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 16:13:51,246 - data.model - INFO - Using device: cuda
2025-06-06 16:13:51,248 - data.model - INFO - Loading CLIP model...
2025-06-06 16:13:57,453 - data.model - INFO - CLIP model loaded successfully
2025-06-06 16:13:57,453 - data.model - INFO - Loading SBERT model...
2025-06-06 16:13:57,461 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 16:14:03,009 - data.model - INFO - SBERT model loaded successfully
2025-06-06 16:14:03,009 - data.model - INFO - Loading BLIP model...
2025-06-06 16:14:09,900 - data.model - INFO - BLIP model loaded successfully
2025-06-06 16:14:09,900 - data.model - INFO - Configuring Gemini API...
2025-06-06 16:14:09,901 - data.model - INFO - Gemini API configured successfully
2025-06-06 16:14:09,903 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 16:14:09,903 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 16:14:09,903 - data.model - INFO - Loading models...
2025-06-06 16:14:22,210 - data.model - INFO - Models loaded successfully!
2025-06-06 16:14:22,212 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 16:14:22,317 - data.model - INFO - Loaded 5000 products with embeddings
2025-06-06 16:14:22,318 - data.model - INFO - Image embeddings shape: (5000, 512)
2025-06-06 16:14:22,318 - data.model - INFO - Text embeddings shape: (5000, 512)
2025-06-06 16:14:22,319 - data.model - INFO - Building FAISS indexes...
2025-06-06 16:14:22,467 - data.model - INFO - Indexes built successfully!
2025-06-06 16:14:22,472 - data.model - INFO - Loading dataset...
2025-06-06 16:14:22,966 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 16:14:22,966 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 16:14:22,967 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 16:14:22,973 - __main__ - INFO - Starting FastAPI server...
2025-06-06 16:14:40,036 - __main__ - INFO - Received recommendation request
2025-06-06 16:14:40,037 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 16:14:40,037 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 16:14:40,038 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4068889640764753743.jpg
2025-06-06 16:14:40,040 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 16:14:40,042 - data.model - INFO - Starting recommendation process
2025-06-06 16:14:40,042 - data.model - INFO - Processing image input...
2025-06-06 16:14:41,772 - data.model - INFO - Processing image-only input...
2025-06-06 16:14:41,855 - data.model - INFO - Found 10 similar product IDs
2025-06-06 16:14:41,857 - data.model - INFO - Created similar products DataFrame with columns: ['id', 'text', 'score_img']
2025-06-06 16:14:41,872 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 16:14:41,873 - data.model - INFO - Generating complementary recommendations...
2025-06-06 16:14:43,351 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 16:14:48,156 - data.model - INFO - Generated 5 complementary categories
2025-06-06 16:14:48,602 - data.model - INFO - Found 10 unique complementary products
2025-06-06 16:14:48,606 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 16:14:48,606 - data.model - INFO - Processing final results...
2025-06-06 16:14:48,607 - data.model - INFO - Clearing output directories...
2025-06-06 16:14:48,609 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 16:14:48,612 - data.model - INFO - Cleared F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 16:14:48,613 - data.model - INFO - 
--- Downloading Recommendation Product Images ---
2025-06-06 16:14:48,615 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\recommendProducts
2025-06-06 16:14:48,624 - data.model - INFO - Downloading image for Product ID 11527...
2025-06-06 16:14:48,925 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\11527.jpg
2025-06-06 16:14:48,926 - data.model - INFO - Downloading image for Product ID 41250...
2025-06-06 16:14:49,309 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\41250.jpg
2025-06-06 16:14:49,310 - data.model - INFO - Downloading image for Product ID 43735...
2025-06-06 16:14:49,710 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\43735.jpg
2025-06-06 16:14:49,712 - data.model - INFO - Downloading image for Product ID 9259...
2025-06-06 16:14:49,922 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\9259.jpg
2025-06-06 16:14:49,924 - data.model - INFO - Downloading image for Product ID 18609...
2025-06-06 16:14:50,278 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\18609.jpg
2025-06-06 16:14:50,278 - data.model - INFO - Downloading image for Product ID 18638...
2025-06-06 16:14:50,472 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\18638.jpg
2025-06-06 16:14:50,473 - data.model - INFO - Downloading image for Product ID 3700...
2025-06-06 16:14:50,769 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\3700.jpg
2025-06-06 16:14:50,772 - data.model - INFO - Downloading image for Product ID 27222...
2025-06-06 16:14:50,944 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\27222.jpg
2025-06-06 16:14:50,945 - data.model - INFO - Downloading image for Product ID 12303...
2025-06-06 16:14:51,131 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\recommendProducts\12303.jpg
2025-06-06 16:14:51,132 - data.model - INFO - Downloading image for Product ID 59231...
2025-06-06 16:15:01,168 - data.model - ERROR - Failed to download image for 59231: HTTPConnectionPool(host='assets.myntassets.com', port=80): Read timed out. (read timeout=10)
2025-06-06 16:15:01,169 - data.model - INFO - 
--- Downloading Similar Product Images ---
2025-06-06 16:15:01,169 - data.model - INFO - Downloading images for 10 products to F:\Appian_Hackathon\server\data\images\similarProducts
2025-06-06 16:15:01,173 - data.model - INFO - Downloading image for Product ID 4171...
2025-06-06 16:15:01,353 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\4171.jpg
2025-06-06 16:15:01,353 - data.model - INFO - Downloading image for Product ID 26152...
2025-06-06 16:15:01,646 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\26152.jpg
2025-06-06 16:15:01,647 - data.model - INFO - Downloading image for Product ID 35971...
2025-06-06 16:15:01,928 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\35971.jpg
2025-06-06 16:15:01,928 - data.model - INFO - Downloading image for Product ID 20234...
2025-06-06 16:15:02,246 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\20234.jpg
2025-06-06 16:15:02,247 - data.model - INFO - Downloading image for Product ID 27475...
2025-06-06 16:15:02,440 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\27475.jpg
2025-06-06 16:15:02,441 - data.model - INFO - Downloading image for Product ID 59066...
2025-06-06 16:15:02,739 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\59066.jpg
2025-06-06 16:15:02,740 - data.model - INFO - Downloading image for Product ID 42081...
2025-06-06 16:15:02,884 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\42081.jpg
2025-06-06 16:15:02,885 - data.model - INFO - Downloading image for Product ID 30036...
2025-06-06 16:15:03,050 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\30036.jpg
2025-06-06 16:15:03,051 - data.model - INFO - Downloading image for Product ID 42017...
2025-06-06 16:15:03,188 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\42017.jpg
2025-06-06 16:15:03,191 - data.model - INFO - Downloading image for Product ID 45203...
2025-06-06 16:15:03,391 - data.model - INFO - Successfully saved image: F:\Appian_Hackathon\server\data\images\similarProducts\45203.jpg
2025-06-06 16:15:03,393 - data.model - INFO - 
--- Creating products.js file ---
2025-06-06 16:15:03,394 - data.model - INFO - Creating products.js file...
2025-06-06 16:15:03,396 - data.model - INFO - Created 3 base products
2025-06-06 16:15:03,399 - data.model - INFO - Created 10 similar products
2025-06-06 16:15:03,405 - data.model - INFO - Created 10 recommended products
2025-06-06 16:15:03,942 - data.model - INFO - Successfully processed recommendations
2025-06-06 16:15:03,942 - data.model - INFO - Recommendation process completed successfully
2025-06-06 16:15:03,942 - __main__ - INFO - Received results from recommender
2025-06-06 16:15:03,943 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 16:15:03,943 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:15:03,945 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 16:15:03,946 - __main__ - INFO - Renaming column id to productId
2025-06-06 16:15:03,948 - __main__ - INFO - Renaming column text to productName
2025-06-06 16:15:03,949 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:15:03,953 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:15:03,955 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:15:03,955 - __main__ - INFO - Adding missing column: season
2025-06-06 16:15:03,957 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:15:03,958 - __main__ - INFO - Adding missing column: image
2025-06-06 16:15:03,961 - __main__ - INFO - Adding missing column: price
2025-06-06 16:15:03,971 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:15:03,972 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 16:15:03,972 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:15:03,973 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 16:15:03,973 - __main__ - INFO - Renaming column id to productId
2025-06-06 16:15:03,975 - __main__ - INFO - Renaming column text to productName
2025-06-06 16:15:03,975 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:15:03,979 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:15:03,981 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:15:03,983 - __main__ - INFO - Adding missing column: season
2025-06-06 16:15:03,984 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:15:03,984 - __main__ - INFO - Adding missing column: image
2025-06-06 16:15:03,989 - __main__ - INFO - Adding missing column: price
2025-06-06 16:15:03,996 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:15:03,997 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 16:15:03,998 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_4068889640764753743.jpg
2025-06-06 16:19:53,845 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 16:19:53,915 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 16:19:53,940 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 16:20:38,694 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 16:20:40,180 - data.model - INFO - Using device: cuda
2025-06-06 16:20:40,180 - data.model - INFO - Loading CLIP model...
2025-06-06 16:20:45,012 - data.model - INFO - CLIP model loaded successfully
2025-06-06 16:20:45,012 - data.model - INFO - Loading SBERT model...
2025-06-06 16:20:45,018 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 16:20:50,741 - data.model - INFO - SBERT model loaded successfully
2025-06-06 16:20:50,741 - data.model - INFO - Loading BLIP model...
2025-06-06 16:20:57,448 - data.model - INFO - BLIP model loaded successfully
2025-06-06 16:20:57,448 - data.model - INFO - Configuring Gemini API...
2025-06-06 16:20:57,450 - data.model - INFO - Gemini API configured successfully
2025-06-06 16:20:57,451 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 16:20:57,451 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 16:20:57,452 - data.model - INFO - Loading models...
2025-06-06 16:21:09,574 - data.model - INFO - Models loaded successfully!
2025-06-06 16:21:09,575 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 16:21:09,606 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 16:21:09,609 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 16:21:09,610 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 16:21:09,610 - data.model - INFO - Building FAISS indexes...
2025-06-06 16:21:09,698 - data.model - INFO - Indexes built successfully!
2025-06-06 16:21:09,703 - data.model - INFO - Loading dataset...
2025-06-06 16:21:10,153 - data.model - INFO - DF shape: (44445, 11)
2025-06-06 16:21:10,202 - data.model - INFO - DF head:   productId gender  ...                                               link price
0     15970    Men  ...  http://assets.myntassets.com/v1/images/style/p...   842
1     39386    Men  ...  http://assets.myntassets.com/v1/images/style/p...  1531
2     21379    Men  ...  http://assets.myntassets.com/v1/images/style/p...  1882
3     53759    Men  ...  http://assets.myntassets.com/v1/images/style/p...   882
4      1855    Men  ...  http://assets.myntassets.com/v1/images/style/p...  1085

[5 rows x 11 columns]

2025-06-06 16:21:10,202 - data.model - INFO - DF columns: ['productId', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'usage', 'productDisplayName', 'link', 'price']
2025-06-06 16:21:10,203 - data.model - INFO - Dataset loaded with 44445 records
2025-06-06 16:21:10,203 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 16:21:10,203 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 16:21:10,213 - __main__ - INFO - Starting FastAPI server...
2025-06-06 16:21:25,260 - __main__ - INFO - Received recommendation request
2025-06-06 16:21:25,261 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 16:21:25,261 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 16:21:25,263 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_1502551692091689072.jpg
2025-06-06 16:21:25,264 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 16:21:25,264 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_1502551692091689072.jpg, prompt: None
2025-06-06 16:21:25,266 - data.model - INFO - Processing image input...
2025-06-06 16:21:27,101 - data.model - INFO - Processing image-only input...
2025-06-06 16:21:27,173 - data.model - INFO - Saved similar products to: ./similarProducts.csv
2025-06-06 16:21:27,173 - data.model - INFO - Similar product IDs: ['59066', '26152', '42081', '30036', '45203', '35971', '42017', '4171', '20234', '27475']
2025-06-06 16:21:27,175 - data.model - INFO - Generating complementary recommendations...
2025-06-06 16:21:28,568 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 16:21:32,006 - data.model - INFO - Generated 5 complementary categories
2025-06-06 16:21:32,489 - data.model - INFO - Saved recommendations to: ./recommendProducts.csv
2025-06-06 16:21:32,490 - data.model - INFO - Recommended product IDs: ['12703', '12303', '18638', '57131', '48329', '57792', '25722', '24409', '3700', '35912']
2025-06-06 16:21:32,490 - data.model - INFO - Recommendation process completed successfully
2025-06-06 16:21:32,491 - __main__ - INFO - Received results from recommender
2025-06-06 16:21:32,491 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 16:21:32,491 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:21:32,492 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_img']
2025-06-06 16:21:32,492 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:21:32,494 - __main__ - INFO - Adding missing column: productName
2025-06-06 16:21:32,495 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:21:32,496 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:21:32,497 - __main__ - INFO - Adding missing column: season
2025-06-06 16:21:32,498 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:21:32,499 - __main__ - INFO - Adding missing column: image
2025-06-06 16:21:32,501 - __main__ - INFO - Adding missing column: price
2025-06-06 16:21:32,508 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:21:32,508 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 16:21:32,508 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:21:32,509 - __main__ - INFO - Original DataFrame columns: ['productId', 'productDisplayName', 'score_txt']
2025-06-06 16:21:32,511 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:21:32,514 - __main__ - INFO - Adding missing column: productName
2025-06-06 16:21:32,515 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:21:32,516 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:21:32,518 - __main__ - INFO - Adding missing column: season
2025-06-06 16:21:32,520 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:21:32,521 - __main__ - INFO - Adding missing column: image
2025-06-06 16:21:32,524 - __main__ - INFO - Adding missing column: price
2025-06-06 16:21:32,530 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:21:32,531 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 16:21:32,533 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_1502551692091689072.jpg
2025-06-06 16:26:24,885 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 16:26:24,954 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 16:26:24,975 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 16:27:11,368 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 16:27:12,962 - data.model - INFO - Using device: cuda
2025-06-06 16:27:12,963 - data.model - INFO - Loading CLIP model...
2025-06-06 16:27:19,213 - data.model - INFO - CLIP model loaded successfully
2025-06-06 16:27:19,216 - data.model - INFO - Loading SBERT model...
2025-06-06 16:27:19,222 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 16:27:24,513 - data.model - INFO - SBERT model loaded successfully
2025-06-06 16:27:24,513 - data.model - INFO - Loading BLIP model...
2025-06-06 16:27:31,019 - data.model - INFO - BLIP model loaded successfully
2025-06-06 16:27:31,021 - data.model - INFO - Configuring Gemini API...
2025-06-06 16:27:31,022 - data.model - INFO - Gemini API configured successfully
2025-06-06 16:27:31,023 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 16:27:31,025 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 16:27:31,025 - data.model - INFO - Loading models...
2025-06-06 16:27:44,119 - data.model - INFO - Models loaded successfully!
2025-06-06 16:27:44,120 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 16:27:44,152 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 16:27:44,155 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 16:27:44,156 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 16:27:44,157 - data.model - INFO - Building FAISS indexes...
2025-06-06 16:27:44,266 - data.model - INFO - Indexes built successfully!
2025-06-06 16:27:44,273 - data.model - INFO - Loading dataset...
2025-06-06 16:27:44,338 - data.model - INFO - DF shape: (5000, 12)
2025-06-06 16:27:44,373 - data.model - INFO - DF head:       id  ...                                               text
0  15970  ...          Casual | Turtle Check Men Navy Blue Shirt
1  39386  ...        Casual | Peter England Men Party Blue Jeans
2  59263  ...                  Casual | Titan Women Silver Watch
3  21379  ...  Casual | Manchester United Men Solid Black Tra...
4  53759  ...                     Casual | Puma Men Grey T-shirt

[5 rows x 12 columns]

2025-06-06 16:27:44,374 - data.model - INFO - DF columns: ['id', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text']
2025-06-06 16:27:44,374 - data.model - INFO - Dataset loaded with 5000 records
2025-06-06 16:27:44,375 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 16:27:44,375 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 16:27:44,385 - __main__ - INFO - Starting FastAPI server...
2025-06-06 16:28:58,496 - __main__ - INFO - Received recommendation request
2025-06-06 16:28:58,497 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 16:28:58,497 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 16:28:58,498 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-4794397950761168001.jpg
2025-06-06 16:28:58,498 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 16:28:58,498 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_-4794397950761168001.jpg, prompt: None
2025-06-06 16:28:58,500 - data.model - INFO - Processing image input...
2025-06-06 16:29:00,420 - data.model - INFO - Processing image-only input...
2025-06-06 16:29:00,506 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 16:29:00,506 - data.model - INFO - Generating complementary recommendations...
2025-06-06 16:29:01,931 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 16:29:06,686 - data.model - INFO - Generated 5 complementary categories
2025-06-06 16:29:07,173 - data.model - INFO - Recommended product IDs: ['26536', '54516', '54517', '13073', '30233', '24260', '11517', '20895', '54542', '26539']
2025-06-06 16:29:07,174 - data.model - INFO - Recommendation process completed successfully
2025-06-06 16:29:07,174 - __main__ - INFO - Received results from recommender
2025-06-06 16:29:07,174 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 16:29:07,175 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:29:07,175 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_img']
2025-06-06 16:29:07,175 - __main__ - INFO - Renaming column id to productId
2025-06-06 16:29:07,175 - __main__ - INFO - Renaming column text to productName
2025-06-06 16:29:07,176 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:29:07,178 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:29:07,178 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:29:07,178 - __main__ - INFO - Adding missing column: season
2025-06-06 16:29:07,180 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:29:07,181 - __main__ - INFO - Adding missing column: image
2025-06-06 16:29:07,182 - __main__ - INFO - Adding missing column: price
2025-06-06 16:29:07,188 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:29:07,190 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 16:29:07,190 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:29:07,190 - __main__ - INFO - Original DataFrame columns: ['id', 'text', 'score_txt']
2025-06-06 16:29:07,191 - __main__ - INFO - Renaming column id to productId
2025-06-06 16:29:07,192 - __main__ - INFO - Renaming column text to productName
2025-06-06 16:29:07,195 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:29:07,198 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:29:07,199 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:29:07,201 - __main__ - INFO - Adding missing column: season
2025-06-06 16:29:07,202 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:29:07,203 - __main__ - INFO - Adding missing column: image
2025-06-06 16:29:07,205 - __main__ - INFO - Adding missing column: price
2025-06-06 16:29:07,211 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:29:07,212 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 16:29:07,214 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_-4794397950761168001.jpg
2025-06-06 16:46:41,536 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 16:46:41,607 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 16:46:41,631 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 16:47:24,682 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 16:47:25,905 - data.model - INFO - Using device: cuda
2025-06-06 16:47:25,906 - data.model - INFO - Loading CLIP model...
2025-06-06 16:47:31,030 - data.model - INFO - CLIP model loaded successfully
2025-06-06 16:47:31,030 - data.model - INFO - Loading SBERT model...
2025-06-06 16:47:31,036 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 16:47:36,759 - data.model - INFO - SBERT model loaded successfully
2025-06-06 16:47:36,760 - data.model - INFO - Loading BLIP model...
2025-06-06 16:47:42,743 - data.model - INFO - BLIP model loaded successfully
2025-06-06 16:47:42,744 - data.model - INFO - Configuring Gemini API...
2025-06-06 16:47:42,744 - data.model - INFO - Gemini API configured successfully
2025-06-06 16:47:42,747 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 16:47:42,748 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 16:47:42,748 - data.model - INFO - Loading models...
2025-06-06 16:47:54,510 - data.model - INFO - Models loaded successfully!
2025-06-06 16:47:54,511 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 16:47:54,564 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 16:47:54,567 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 16:47:54,568 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 16:47:54,570 - data.model - INFO - Building FAISS indexes...
2025-06-06 16:47:54,669 - data.model - INFO - Indexes built successfully!
2025-06-06 16:47:54,673 - data.model - INFO - Loading dataset...
2025-06-06 16:53:43,751 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 16:53:43,827 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 16:53:43,849 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 16:54:26,646 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 16:54:27,841 - data.model - INFO - Using device: cuda
2025-06-06 16:54:27,842 - data.model - INFO - Loading CLIP model...
2025-06-06 16:54:33,535 - data.model - INFO - CLIP model loaded successfully
2025-06-06 16:54:33,536 - data.model - INFO - Loading SBERT model...
2025-06-06 16:54:33,544 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 16:54:38,463 - data.model - INFO - SBERT model loaded successfully
2025-06-06 16:54:38,463 - data.model - INFO - Loading BLIP model...
2025-06-06 16:54:44,990 - data.model - INFO - BLIP model loaded successfully
2025-06-06 16:54:44,992 - data.model - INFO - Configuring Gemini API...
2025-06-06 16:54:44,992 - data.model - INFO - Gemini API configured successfully
2025-06-06 16:54:44,993 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 16:54:44,994 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 16:54:44,994 - data.model - INFO - Loading models...
2025-06-06 16:54:56,617 - data.model - INFO - Models loaded successfully!
2025-06-06 16:54:56,618 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 16:54:56,647 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 16:54:56,649 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 16:54:56,649 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 16:54:56,651 - data.model - INFO - Building FAISS indexes...
2025-06-06 16:54:56,747 - data.model - INFO - Indexes built successfully!
2025-06-06 16:54:56,753 - data.model - INFO - Loading dataset...
2025-06-06 16:54:56,825 - data.model - INFO - DF shape: (5000, 12)
2025-06-06 16:54:56,862 - data.model - INFO - DF head:   productId  ...                                               text
0     15970  ...          Casual | Turtle Check Men Navy Blue Shirt
1     39386  ...        Casual | Peter England Men Party Blue Jeans
2     59263  ...                  Casual | Titan Women Silver Watch
3     21379  ...  Casual | Manchester United Men Solid Black Tra...
4     53759  ...                     Casual | Puma Men Grey T-shirt

[5 rows x 12 columns]

2025-06-06 16:54:56,863 - data.model - INFO - DF columns: ['productId', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text']
2025-06-06 16:54:56,863 - data.model - INFO - Dataset loaded with 5000 records
2025-06-06 16:54:56,864 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 16:54:56,864 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 16:54:56,875 - __main__ - INFO - Starting FastAPI server...
2025-06-06 16:55:07,587 - __main__ - INFO - Received recommendation request
2025-06-06 16:55:07,588 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 16:55:07,588 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 16:55:07,589 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_8431443060826030922.jpg
2025-06-06 16:55:07,589 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 16:55:07,589 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_8431443060826030922.jpg, prompt: None
2025-06-06 16:55:07,590 - data.model - INFO - Processing image input...
2025-06-06 16:55:09,438 - data.model - INFO - Processing image-only input...
2025-06-06 16:55:09,522 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 16:55:09,523 - data.model - INFO - Generating complementary recommendations...
2025-06-06 16:55:10,899 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 16:55:17,586 - data.model - INFO - Generated 5 complementary categories
2025-06-06 16:55:18,063 - data.model - INFO - Recommended product IDs: ['26536', '54516', '54517', '13073', '30233', '24260', '11517', '20895', '54542', '26539']
2025-06-06 16:55:18,064 - data.model - INFO - Recommendation process completed successfully
2025-06-06 16:55:18,064 - __main__ - INFO - Received results from recommender
2025-06-06 16:55:18,064 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 16:55:18,065 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:55:18,065 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_img']
2025-06-06 16:55:18,066 - __main__ - INFO - Renaming column text to productName
2025-06-06 16:55:18,068 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:55:18,073 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:55:18,074 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:55:18,076 - __main__ - INFO - Adding missing column: season
2025-06-06 16:55:18,077 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:55:18,077 - __main__ - INFO - Adding missing column: image
2025-06-06 16:55:18,079 - __main__ - INFO - Adding missing column: price
2025-06-06 16:55:18,089 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:55:18,089 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 16:55:18,089 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 16:55:18,091 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_txt']
2025-06-06 16:55:18,092 - __main__ - INFO - Renaming column text to productName
2025-06-06 16:55:18,093 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 16:55:18,096 - __main__ - INFO - Adding missing column: articleType
2025-06-06 16:55:18,097 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 16:55:18,098 - __main__ - INFO - Adding missing column: season
2025-06-06 16:55:18,098 - __main__ - INFO - Adding missing column: usage
2025-06-06 16:55:18,099 - __main__ - INFO - Adding missing column: image
2025-06-06 16:55:18,103 - __main__ - INFO - Adding missing column: price
2025-06-06 16:55:18,108 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 16:55:18,109 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 16:55:18,112 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_8431443060826030922.jpg
2025-06-06 17:00:32,195 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 17:00:32,252 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 17:00:32,283 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 17:01:18,076 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 17:01:19,607 - data.model - INFO - Using device: cuda
2025-06-06 17:01:19,608 - data.model - INFO - Loading CLIP model...
2025-06-06 17:01:25,669 - data.model - INFO - CLIP model loaded successfully
2025-06-06 17:01:25,671 - data.model - INFO - Loading SBERT model...
2025-06-06 17:01:25,676 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 17:01:30,893 - data.model - INFO - SBERT model loaded successfully
2025-06-06 17:01:30,893 - data.model - INFO - Loading BLIP model...
2025-06-06 17:01:36,798 - data.model - INFO - BLIP model loaded successfully
2025-06-06 17:01:36,799 - data.model - INFO - Configuring Gemini API...
2025-06-06 17:01:36,801 - data.model - INFO - Gemini API configured successfully
2025-06-06 17:01:36,802 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 17:01:36,802 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 17:01:36,803 - data.model - INFO - Loading models...
2025-06-06 17:01:48,274 - data.model - INFO - Models loaded successfully!
2025-06-06 17:01:48,274 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 17:01:48,302 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 17:01:48,304 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 17:01:48,305 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 17:01:48,305 - data.model - INFO - Building FAISS indexes...
2025-06-06 17:01:48,386 - data.model - INFO - Indexes built successfully!
2025-06-06 17:01:48,389 - data.model - INFO - Loading dataset...
2025-06-06 17:01:48,461 - data.model - INFO - DF shape: (5000, 12)
2025-06-06 17:01:48,498 - data.model - INFO - DF head:   productId  ...                                               text
0     15970  ...          Casual | Turtle Check Men Navy Blue Shirt
1     39386  ...        Casual | Peter England Men Party Blue Jeans
2     59263  ...                  Casual | Titan Women Silver Watch
3     21379  ...  Casual | Manchester United Men Solid Black Tra...
4     53759  ...                     Casual | Puma Men Grey T-shirt

[5 rows x 12 columns]

2025-06-06 17:01:48,498 - data.model - INFO - DF columns: ['productId', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text']
2025-06-06 17:01:48,499 - data.model - INFO - Dataset loaded with 5000 records
2025-06-06 17:01:48,499 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 17:01:48,499 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 17:01:48,508 - __main__ - INFO - Starting FastAPI server...
2025-06-06 17:02:02,143 - __main__ - INFO - Received recommendation request
2025-06-06 17:02:02,144 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 17:02:02,144 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:02:02,147 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_1269834846207596142.jpg
2025-06-06 17:02:02,147 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:02:02,147 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_1269834846207596142.jpg, prompt: None
2025-06-06 17:02:02,148 - data.model - INFO - Processing image input...
2025-06-06 17:02:03,822 - data.model - INFO - Processing image-only input...
2025-06-06 17:02:03,908 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 17:02:03,917 - data.model - INFO - Generating complementary recommendations...
2025-06-06 17:02:05,183 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 17:02:08,788 - data.model - INFO - Generated 5 complementary categories
2025-06-06 17:02:09,199 - data.model - INFO - Recommended product IDs: ['26536', '54516', '30233', '24260', '13073', '54517', '11517', '26539', '54542', '54521']
2025-06-06 17:02:09,202 - data.model - INFO - Recommendation process completed successfully
2025-06-06 17:02:09,203 - __main__ - INFO - Received results from recommender
2025-06-06 17:02:09,205 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 17:02:09,205 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:02:09,205 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_img']
2025-06-06 17:02:09,206 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:02:09,207 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:02:09,210 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:02:09,212 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:02:09,212 - __main__ - INFO - Adding missing column: season
2025-06-06 17:02:09,213 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:02:09,214 - __main__ - INFO - Adding missing column: image
2025-06-06 17:02:09,216 - __main__ - INFO - Adding missing column: price
2025-06-06 17:02:09,223 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:02:09,224 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 17:02:09,224 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:02:09,224 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_txt']
2025-06-06 17:02:09,225 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:02:09,226 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:02:09,228 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:02:09,230 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:02:09,230 - __main__ - INFO - Adding missing column: season
2025-06-06 17:02:09,231 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:02:09,232 - __main__ - INFO - Adding missing column: image
2025-06-06 17:02:09,235 - __main__ - INFO - Adding missing column: price
2025-06-06 17:02:09,238 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:02:09,238 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 17:02:09,240 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_1269834846207596142.jpg
2025-06-06 17:12:52,400 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 17:12:52,473 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 17:12:52,499 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 17:13:32,809 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 17:13:34,222 - data.model - INFO - Using device: cuda
2025-06-06 17:13:34,222 - data.model - INFO - Loading CLIP model...
2025-06-06 17:13:39,559 - data.model - INFO - CLIP model loaded successfully
2025-06-06 17:13:39,560 - data.model - INFO - Loading SBERT model...
2025-06-06 17:13:39,567 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 17:13:44,393 - data.model - INFO - SBERT model loaded successfully
2025-06-06 17:13:44,393 - data.model - INFO - Loading BLIP model...
2025-06-06 17:13:50,548 - data.model - INFO - BLIP model loaded successfully
2025-06-06 17:13:50,549 - data.model - INFO - Configuring Gemini API...
2025-06-06 17:13:50,549 - data.model - INFO - Gemini API configured successfully
2025-06-06 17:13:50,551 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 17:13:50,552 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 17:13:50,552 - data.model - INFO - Loading models...
2025-06-06 17:14:02,040 - data.model - INFO - Models loaded successfully!
2025-06-06 17:14:02,041 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 17:14:02,068 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 17:14:02,071 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 17:14:02,072 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 17:14:02,072 - data.model - INFO - Building FAISS indexes...
2025-06-06 17:14:02,140 - data.model - INFO - Indexes built successfully!
2025-06-06 17:14:02,144 - data.model - INFO - Loading dataset...
2025-06-06 17:14:02,642 - data.model - INFO - DF shape: (44446, 13)
2025-06-06 17:14:02,678 - data.model - INFO - DF head:   productId  ...                                               link
0     15970  ...  http://assets.myntassets.com/v1/images/style/p...
1     39386  ...  http://assets.myntassets.com/v1/images/style/p...
2     59263  ...  http://assets.myntassets.com/v1/images/style/p...
3     21379  ...  http://assets.myntassets.com/v1/images/style/p...
4     53759  ...  http://assets.myntassets.com/v1/images/style/p...

[5 rows x 13 columns]

2025-06-06 17:14:02,680 - data.model - INFO - DF columns: ['productId', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text', 'link']
2025-06-06 17:14:02,682 - data.model - INFO - Dataset loaded with 44446 records
2025-06-06 17:14:02,682 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 17:14:02,682 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 17:14:02,692 - __main__ - INFO - Starting FastAPI server...
2025-06-06 17:14:20,062 - __main__ - INFO - Received recommendation request
2025-06-06 17:14:20,062 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 17:14:20,063 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:14:20,066 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg
2025-06-06 17:14:20,066 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:14:20,067 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg, prompt: None
2025-06-06 17:14:20,068 - data.model - INFO - Processing image input...
2025-06-06 17:14:21,926 - data.model - INFO - Processing image-only input...
2025-06-06 17:14:21,988 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 17:14:21,994 - __main__ - ERROR - Error in process_recommendations: [Errno 13] Permission denied: './similarProducts.csv'
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 412, in recommend
    sim_df[["productId"]].to_csv(os.path.join(self.output_dir, "similarProducts.csv"), index=False)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
PermissionError: [Errno 13] Permission denied: './similarProducts.csv'
2025-06-06 17:14:28,458 - __main__ - INFO - Received recommendation request
2025-06-06 17:14:28,459 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 17:14:28,459 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:14:28,465 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg
2025-06-06 17:14:28,465 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:14:28,466 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg, prompt: None
2025-06-06 17:14:28,467 - data.model - INFO - Processing image input...
2025-06-06 17:14:28,659 - data.model - INFO - Processing image-only input...
2025-06-06 17:14:28,667 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 17:14:28,669 - __main__ - ERROR - Error in process_recommendations: [Errno 13] Permission denied: './similarProducts.csv'
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 412, in recommend
    sim_df[["productId"]].to_csv(os.path.join(self.output_dir, "similarProducts.csv"), index=False)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
PermissionError: [Errno 13] Permission denied: './similarProducts.csv'
2025-06-06 17:14:38,987 - __main__ - INFO - Received recommendation request
2025-06-06 17:14:38,990 - __main__ - INFO - Request data - Text: blue t shirt, Image: Present
2025-06-06 17:14:38,992 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:14:38,996 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg
2025-06-06 17:14:38,996 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:14:38,997 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg, prompt: blue t shirt
2025-06-06 17:14:38,999 - data.model - INFO - Processing image input...
2025-06-06 17:14:39,157 - data.model - INFO - Processing combined image and text input...
2025-06-06 17:14:39,482 - data.model - INFO - Similar product IDs: ['15349', '2274', '2272', '14001', '7535', '43506', '38639', '10490', '44341', '12199']
2025-06-06 17:14:39,486 - __main__ - ERROR - Error in process_recommendations: [Errno 13] Permission denied: './similarProducts.csv'
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 412, in recommend
    sim_df[["productId"]].to_csv(os.path.join(self.output_dir, "similarProducts.csv"), index=False)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
PermissionError: [Errno 13] Permission denied: './similarProducts.csv'
2025-06-06 17:14:41,164 - __main__ - INFO - Received recommendation request
2025-06-06 17:14:41,165 - __main__ - INFO - Request data - Text: blue t shirt, Image: Present
2025-06-06 17:14:41,165 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:14:41,167 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg
2025-06-06 17:14:41,168 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:14:41,172 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg, prompt: blue t shirt
2025-06-06 17:14:41,173 - data.model - INFO - Processing image input...
2025-06-06 17:14:41,324 - data.model - INFO - Processing combined image and text input...
2025-06-06 17:14:41,393 - data.model - INFO - Similar product IDs: ['15349', '2274', '2272', '14001', '7535', '43506', '38639', '10490', '44341', '12199']
2025-06-06 17:14:41,396 - __main__ - ERROR - Error in process_recommendations: [Errno 13] Permission denied: './similarProducts.csv'
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 412, in recommend
    sim_df[["productId"]].to_csv(os.path.join(self.output_dir, "similarProducts.csv"), index=False)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
PermissionError: [Errno 13] Permission denied: './similarProducts.csv'
2025-06-06 17:15:53,590 - __main__ - INFO - Received recommendation request
2025-06-06 17:15:53,591 - __main__ - INFO - Request data - Text: blue t shirt, Image: Present
2025-06-06 17:15:53,592 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:15:53,597 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg
2025-06-06 17:15:53,598 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:15:53,598 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg, prompt: blue t shirt
2025-06-06 17:15:53,599 - data.model - INFO - Processing image input...
2025-06-06 17:15:53,795 - data.model - INFO - Processing combined image and text input...
2025-06-06 17:15:53,865 - data.model - INFO - Similar product IDs: ['15349', '2274', '2272', '14001', '7535', '43506', '38639', '10490', '44341', '12199']
2025-06-06 17:15:53,879 - data.model - INFO - Generating complementary recommendations...
2025-06-06 17:15:55,179 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 17:15:59,339 - data.model - INFO - Generated 5 complementary categories
2025-06-06 17:15:59,686 - data.model - INFO - Recommended product IDs: ['54516', '26536', '11517', '54517', '13073', '24260', '30233', '26539', '54542', '54526']
2025-06-06 17:15:59,690 - data.model - INFO - Recommendation process completed successfully
2025-06-06 17:15:59,690 - __main__ - INFO - Received results from recommender
2025-06-06 17:15:59,690 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 17:15:59,690 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:15:59,692 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_img']
2025-06-06 17:15:59,692 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:15:59,694 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:15:59,700 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:15:59,700 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:15:59,700 - __main__ - INFO - Adding missing column: season
2025-06-06 17:15:59,701 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:15:59,702 - __main__ - INFO - Adding missing column: image
2025-06-06 17:15:59,705 - __main__ - INFO - Adding missing column: price
2025-06-06 17:15:59,715 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:15:59,715 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 17:15:59,716 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:15:59,716 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_txt']
2025-06-06 17:15:59,717 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:15:59,720 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:15:59,726 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:15:59,729 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:15:59,732 - __main__ - INFO - Adding missing column: season
2025-06-06 17:15:59,734 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:15:59,736 - __main__ - INFO - Adding missing column: image
2025-06-06 17:15:59,739 - __main__ - INFO - Adding missing column: price
2025-06-06 17:15:59,743 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:15:59,744 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 17:15:59,746 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_4355985127615147410.jpg
2025-06-06 17:19:10,309 - __main__ - INFO - Received recommendation request
2025-06-06 17:19:10,309 - __main__ - INFO - Request data - Text: blue t shirt, Image: Present
2025-06-06 17:19:10,311 - __main__ - INFO - First 100 chars of base64 image: /9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOJaHR0cDovL25zLmFkb2JlLmNvbS94YXAv
2025-06-06 17:19:10,313 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-1422977042587157328.jpg
2025-06-06 17:19:10,313 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:19:10,314 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_-1422977042587157328.jpg, prompt: blue t shirt
2025-06-06 17:19:10,315 - data.model - INFO - Processing image input...
2025-06-06 17:19:10,449 - data.model - INFO - Processing combined image and text input...
2025-06-06 17:19:10,526 - data.model - INFO - Similar product IDs: ['43538', '39727', '32393', '49652', '11714', '27884', '43506', '27885', '32565', '26369']
2025-06-06 17:19:10,532 - data.model - INFO - Generating complementary recommendations...
2025-06-06 17:19:11,596 - data.model - INFO - Generated caption: a woman wearing a black cardigan jacket
2025-06-06 17:19:14,795 - data.model - INFO - Generated 5 complementary categories
2025-06-06 17:19:15,127 - data.model - INFO - Recommended product IDs: ['39973', '39974', '12509', '12508', '30258', '12506', '39980', '52225', '50377', '24463']
2025-06-06 17:19:15,132 - data.model - INFO - Recommendation process completed successfully
2025-06-06 17:19:15,133 - __main__ - INFO - Received results from recommender
2025-06-06 17:19:15,133 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 17:19:15,133 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:19:15,134 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_img']
2025-06-06 17:19:15,135 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:19:15,136 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:19:15,139 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:19:15,141 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:19:15,142 - __main__ - INFO - Adding missing column: season
2025-06-06 17:19:15,143 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:19:15,144 - __main__ - INFO - Adding missing column: image
2025-06-06 17:19:15,146 - __main__ - INFO - Adding missing column: price
2025-06-06 17:19:15,152 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:19:15,152 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 17:19:15,153 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:19:15,153 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_txt']
2025-06-06 17:19:15,154 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:19:15,156 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:19:15,159 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:19:15,160 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:19:15,162 - __main__ - INFO - Adding missing column: season
2025-06-06 17:19:15,163 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:19:15,164 - __main__ - INFO - Adding missing column: image
2025-06-06 17:19:15,166 - __main__ - INFO - Adding missing column: price
2025-06-06 17:19:15,171 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:19:15,172 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 17:19:15,173 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_-1422977042587157328.jpg
2025-06-06 17:21:35,394 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-06-06 17:21:35,463 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-06-06 17:21:35,484 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-06-06 17:22:14,084 - tensorflow - WARNING - From C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-06 17:22:15,309 - data.model - INFO - Using device: cuda
2025-06-06 17:22:15,309 - data.model - INFO - Loading CLIP model...
2025-06-06 17:22:20,337 - data.model - INFO - CLIP model loaded successfully
2025-06-06 17:22:20,338 - data.model - INFO - Loading SBERT model...
2025-06-06 17:22:20,344 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: paraphrase-MiniLM-L3-v2
2025-06-06 17:22:25,435 - data.model - INFO - SBERT model loaded successfully
2025-06-06 17:22:25,435 - data.model - INFO - Loading BLIP model...
2025-06-06 17:22:31,415 - data.model - INFO - BLIP model loaded successfully
2025-06-06 17:22:31,415 - data.model - INFO - Configuring Gemini API...
2025-06-06 17:22:31,416 - data.model - INFO - Gemini API configured successfully
2025-06-06 17:22:31,418 - __main__ - INFO - Initializing FashionRecommender...
2025-06-06 17:22:31,418 - data.model - INFO - Initializing FashionRecommender...
2025-06-06 17:22:31,418 - data.model - INFO - Loading models...
2025-06-06 17:22:43,126 - data.model - INFO - Models loaded successfully!
2025-06-06 17:22:43,126 - data.model - INFO - Loading embeddings and metadata...
2025-06-06 17:22:43,158 - data.model - INFO - img_embs shape: (5000, 512), sample: [-0.05377   0.01663   0.01843   0.00818   0.005554]
2025-06-06 17:22:43,159 - data.model - INFO - txt_embs shape: (5000, 512), sample: [ 0.01625503 -0.00373982 -0.01780827 -0.00368375 -0.02755962]
2025-06-06 17:22:43,167 - data.model - INFO - valid_indices shape: (5000,), sample: [0 1 2 3 4 5 6 7 8 9]
2025-06-06 17:22:43,168 - data.model - INFO - Building FAISS indexes...
2025-06-06 17:22:43,277 - data.model - INFO - Indexes built successfully!
2025-06-06 17:22:43,282 - data.model - INFO - Loading dataset...
2025-06-06 17:22:43,669 - data.model - INFO - DF shape: (44446, 13)
2025-06-06 17:22:43,703 - data.model - INFO - DF head:   productId  ...                                               link
0     15970  ...  http://assets.myntassets.com/v1/images/style/p...
1     39386  ...  http://assets.myntassets.com/v1/images/style/p...
2     59263  ...  http://assets.myntassets.com/v1/images/style/p...
3     21379  ...  http://assets.myntassets.com/v1/images/style/p...
4     53759  ...  http://assets.myntassets.com/v1/images/style/p...

[5 rows x 13 columns]

2025-06-06 17:22:43,704 - data.model - INFO - DF columns: ['productId', 'gender', 'masterCategory', 'subCategory', 'articleType', 'baseColour', 'season', 'year', 'usage', 'productDisplayName', 'image_path', 'text', 'link']
2025-06-06 17:22:43,705 - data.model - INFO - Dataset loaded with 44446 records
2025-06-06 17:22:43,705 - data.model - INFO - FashionRecommender initialized successfully
2025-06-06 17:22:43,706 - __main__ - INFO - FashionRecommender initialized successfully
2025-06-06 17:22:43,716 - __main__ - INFO - Starting FastAPI server...
2025-06-06 17:22:53,500 - __main__ - INFO - Received recommendation request
2025-06-06 17:22:53,501 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 17:22:53,502 - __main__ - INFO - First 100 chars of base64 image: /9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOJaHR0cDovL25zLmFkb2JlLmNvbS94YXAv
2025-06-06 17:22:53,510 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_-2813820851948704515.jpg
2025-06-06 17:22:53,511 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:22:53,511 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_-2813820851948704515.jpg, prompt: None
2025-06-06 17:22:53,513 - data.model - INFO - Processing image input...
2025-06-06 17:22:55,383 - data.model - INFO - Processing image-only input...
2025-06-06 17:22:55,455 - data.model - INFO - Similar product IDs: ['25915', '21142', '21173', '11379', '35940', '25912', '19585', '12154', '10406', '37223']
2025-06-06 17:22:55,460 - data.model - INFO - Generating complementary recommendations...
2025-06-06 17:22:56,947 - data.model - INFO - Generated caption: a woman wearing a black cardigan jacket
2025-06-06 17:23:02,497 - data.model - INFO - Generated 5 complementary categories
2025-06-06 17:23:02,923 - data.model - INFO - Recommended product IDs: ['52648', '52647', '39974', '39973', '12509', '12508', '54175', '54172', '54174', '42840']
2025-06-06 17:23:02,926 - data.model - INFO - Recommendation process completed successfully
2025-06-06 17:23:02,926 - __main__ - INFO - Received results from recommender
2025-06-06 17:23:02,926 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 17:23:02,927 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:23:02,927 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_img']
2025-06-06 17:23:02,927 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:23:02,928 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:23:02,932 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:23:02,933 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:23:02,933 - __main__ - INFO - Adding missing column: season
2025-06-06 17:23:02,935 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:23:02,938 - __main__ - INFO - Adding missing column: image
2025-06-06 17:23:02,940 - __main__ - INFO - Adding missing column: price
2025-06-06 17:23:02,950 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:23:02,950 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 17:23:02,950 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:23:02,952 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_txt']
2025-06-06 17:23:02,952 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:23:02,953 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:23:02,956 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:23:02,957 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:23:02,958 - __main__ - INFO - Adding missing column: season
2025-06-06 17:23:02,958 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:23:02,959 - __main__ - INFO - Adding missing column: image
2025-06-06 17:23:02,962 - __main__ - INFO - Adding missing column: price
2025-06-06 17:23:02,968 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:23:02,968 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 17:23:02,969 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_-2813820851948704515.jpg
2025-06-06 17:23:58,175 - __main__ - INFO - Received recommendation request
2025-06-06 17:23:58,178 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 17:23:58,178 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:23:58,182 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_7837154681980548639.jpg
2025-06-06 17:23:58,182 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:23:58,182 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_7837154681980548639.jpg, prompt: None
2025-06-06 17:23:58,183 - data.model - INFO - Processing image input...
2025-06-06 17:23:58,349 - data.model - INFO - Processing image-only input...
2025-06-06 17:23:58,359 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 17:23:58,363 - __main__ - ERROR - Error in process_recommendations: [Errno 13] Permission denied: './similar.csv'
Traceback (most recent call last):
  File "F:\Appian_Hackathon\server\api_server.py", line 157, in process_recommendations
    sim_results, comp_results = recommender.recommend(
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "F:\Appian_Hackathon\server\data\model.py", line 412, in recommend
    sim_df[["productId"]].to_csv(os.path.join(self.output_dir, "similar.csv"), index=False)
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\shaur\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
PermissionError: [Errno 13] Permission denied: './similar.csv'
2025-06-06 17:24:20,011 - __main__ - INFO - Received recommendation request
2025-06-06 17:24:20,012 - __main__ - INFO - Request data - Text: None, Image: Present
2025-06-06 17:24:20,012 - __main__ - INFO - First 100 chars of base64 image: /9j/4Rx+RXhpZgAATU0AKgAAAAgADAEAAAMAAAABBDgAAAEBAAMAAAABBaAAAAECAAMAAAADAAAAngEGAAMAAAABAAIAAAESAAMA
2025-06-06 17:24:20,018 - __main__ - INFO - Saved image to: F:\Appian_Hackathon\server\temp\temp_image_7837154681980548639.jpg
2025-06-06 17:24:20,019 - __main__ - INFO - Calling recommender.recommend()
2025-06-06 17:24:20,020 - data.model - INFO - recommend called with img: F:\Appian_Hackathon\server\temp\temp_image_7837154681980548639.jpg, prompt: None
2025-06-06 17:24:20,024 - data.model - INFO - Processing image input...
2025-06-06 17:24:20,226 - data.model - INFO - Processing image-only input...
2025-06-06 17:24:20,232 - data.model - INFO - Similar product IDs: ['15349', '3730', '2274', '3731', '4124', '3338', '3330', '10054', '14001', '12792']
2025-06-06 17:24:20,237 - data.model - INFO - Generating complementary recommendations...
2025-06-06 17:24:21,144 - data.model - INFO - Generated caption: the new nike india cricket jersey
2025-06-06 17:24:24,221 - data.model - INFO - Generated 5 complementary categories
2025-06-06 17:24:24,570 - data.model - INFO - Recommended product IDs: ['26536', '54516', '54517', '13073', '30233', '24260', '11517', '20895', '54542', '26539']
2025-06-06 17:24:24,575 - data.model - INFO - Recommendation process completed successfully
2025-06-06 17:24:24,576 - __main__ - INFO - Received results from recommender
2025-06-06 17:24:24,576 - __main__ - INFO - Converting similar products to dictionary
2025-06-06 17:24:24,577 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:24:24,577 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_img']
2025-06-06 17:24:24,578 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:24:24,579 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:24:24,583 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:24:24,583 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:24:24,584 - __main__ - INFO - Adding missing column: season
2025-06-06 17:24:24,585 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:24:24,587 - __main__ - INFO - Adding missing column: image
2025-06-06 17:24:24,590 - __main__ - INFO - Adding missing column: price
2025-06-06 17:24:24,594 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:24:24,595 - __main__ - INFO - Converting recommended products to dictionary
2025-06-06 17:24:24,595 - __main__ - INFO - Starting DataFrame conversion
2025-06-06 17:24:24,596 - __main__ - INFO - Original DataFrame columns: ['productId', 'text', 'score_txt']
2025-06-06 17:24:24,597 - __main__ - INFO - Renaming column text to productName
2025-06-06 17:24:24,598 - __main__ - INFO - Required columns: ['productId', 'productName', 'articleType', 'subCategory', 'season', 'usage', 'image', 'price']
2025-06-06 17:24:24,602 - __main__ - INFO - Adding missing column: articleType
2025-06-06 17:24:24,603 - __main__ - INFO - Adding missing column: subCategory
2025-06-06 17:24:24,605 - __main__ - INFO - Adding missing column: season
2025-06-06 17:24:24,608 - __main__ - INFO - Adding missing column: usage
2025-06-06 17:24:24,610 - __main__ - INFO - Adding missing column: image
2025-06-06 17:24:24,613 - __main__ - INFO - Adding missing column: price
2025-06-06 17:24:24,618 - __main__ - INFO - Successfully converted DataFrame to dictionary with 10 records
2025-06-06 17:24:24,619 - __main__ - INFO - Processed 10 similar products and 10 recommended products
2025-06-06 17:24:24,621 - __main__ - INFO - Cleaned up temporary image: F:\Appian_Hackathon\server\temp\temp_image_7837154681980548639.jpg
